{"version":3,"sources":["components/tools/images/pen.png","components/tools/images/colorpicker.png","components/tools/images/bucket.png","components/tools/images/eraser.png","store/store.js","components/tools/color-picker.js","components/tools/toolsDomBuilder.js","screens/canvas/resizeWindow.js","components/tools/paintBucket.js","components/tools/pen.js","components/tools/eraser.js","components/tools/stroke.js","screens/canvas/drawing.js","screens/canvas/paint.js","screens/preview/preview.js","screens/canvas/canvasDomBuilder.js","components/frames-list/frameDomBuilder.js","components/frames-list/canvasManager.js","components/frames-list/framesManager.js","components/menu/palettes/palettes.js","screens/preview/previewDomBuilder.js","components/menu/layers-list/layers-list.js","components/menu/settings/settings.js","components/menu/resize/resizeCanvas.js","components/gifModule/jsgif-master/NeuQuant.js","components/gifModule/jsgif-master/LZWEncoder.js","components/gifModule/jsgif-master/GIFEncoder.js","components/menu/export/googleUploader.js","components/menu/export/fromCanvasToFile.js","components/gifModule/jsgif-master/b64.js","components/menu/save/save.js","components/menu/save/saveLocally.js","components/menu/export/export.js","components/menu/import/import.js","components/menu/optionsDomBuilder.js","mainpage/user/user.js","components/menu/import/localSaves.js","mainpage/create/create.js","mainpage/about/about.js","mainpage/home.js","serviceWorker.js","index.js"],"names":["module","exports","preview","createStore","state","arguments","length","undefined","action","type","Object","assign","gif","value","frames","piskelID","projects","store","currentPage","currentColor","backColor","currentTool","fps","customWidth","settings","setBg","title","canvas","currentCanvas","user","name","userID","imageURL","email","token","googleUrl","urlToGif","options","optionsBlock","palette","addColor","customedColorOnChange","id","newValue","$","concat","val","customedColor","match","map","v","parseInt","join","dispatch","css","background-color","attr","toolState","currentColorState","backColorState","subscribe","getState","changeWidth","Tools","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","tool","active","value1","value2","pickedColor","mounted","_this2","document","click","e","colorPickerHandleClick","setState","curColorValue","backColorValue","target","is","curCanv","querySelector","rect","getBoundingClientRect","x","Math","round","clientX","left","y","clientY","top","ctx","getContext","getImageData","data","rgbColor","hexColor","r","g","b","hexR","toString","hexG","hexB","rgbaToHex","children","removeClass","_this3","react_default","a","createElement","className","onMouseEnter","buttonOnHoverIn","onMouseLeave","buttonOnHoverOut","onClick","find","addClass","focus","body","cursor","paintBucketIcon","blur","colorPicker","penIcon","erserIcon","hex","color","nums","exec","rgbToHex","role","switchColorsOnClick","onFocus","onKeyPress","tabIndex","onChange","React","Component","canvasWidth","window","innerWidth","innerHeight","bind","i","imageData","get","putImageData","text","width","endX","endY","mouseDownX","mouseDownY","end","offsetX","offsetY","fillStyle","strokeStyle","canvasSize","ceil","mouseMoveX","floor","mouseMoveY","fillRect","start","globalCompositeOperation","mousemove","radius","startX","startY","lastX","lastY","endStroke","drawCtx","pageX","offsetLeft","pageY","offsetTop","clearRect","lineWidth","beginPath","moveTo","lineTo","stroke","sqrt","arc","PI","mouseup","strokeLines","getColorAtPixel","setColorAtPixel","colorMatch","paintIt","newColor","rgb","col","height","stack","baseColor","clicked","push","pop","goDown","goUp","goLeft","goRight","floodFill","dataURL","toDataURL","background","background-size","anim","newWindow","count","animate","clearTimeout","time","display","style","setTimeout","makeImage","n","canvasImage","Image","insertBefore","next","remove","appendTo","fullSizePreview","close","open","newPreview","clone","justify-content","align-items","newFps","newCount","ready","newAnimate","Canvas","size","penHandleClick","unbind","mousedown","off","openCanvas","num","toggleClass","hoverIn","hasClass","hoverOut","updateId","dragFrame","sortable","disableSelection","dragOff","dragged","currentTarget","parent","insertAfter","removeFrame","copyFrame","hover","cloneWrapper","copyCanvas","addNewFrame","first","last","class","newCanvas","Frames","Preview","Layers","hovered","mouseEnter","getAttribute","onMouseOver","popHintOnMouseOver","mouseIn","mouseOut","Palettes","changed","indexOf","item","key","changeCurColor","addNewColor","Settings","bg","addActiveOnClick","ResizeCanvas","inputVal","maxSize","min","resizeCanvasOnClickHandler","NeuQuant","alphadec","thepicture","lengthcount","samplefac","network","netindex","bias","freq","radpower","thepic","len","sample","p","Array","netbiasshift","intbias","unbiasnet","j","dist","bestd","best","process","rad","alpha","step","delta","samplepixels","pix","lim","initrad","contest","altersingle","alterneigh","learn","smallpos","smallval","q","previouscol","startpos","netsize","inxbuild","index","k","l","colorMap","lo","hi","m","alphabiasshift","biasdist","betafreq","bestpos","bestbiaspos","bestbiasd","intbiasshift","apply","LZWEncoder","imgW","imgH","pixAry","initCodeSize","remaining","curPixel","n_bits","maxcode","g_init_bits","ClearCode","EOFCode","a_count","htab","codetab","free_ent","clear_flg","cur_accum","cur_bits","masks","accum","pixels","color_depth","max","char_out","c","outs","flush_char","cl_block","cl_hash","output","hsize","compress","init_bits","fcode","ent","disp","hshift","MAXCODE","nextPixel","outer_loop","encode","os","writeByte","writeBytes","code","GIFEncoder","chr","String","fromCharCode","ByteArray","bin","prototype","getData","writeUTFBytes","string","charCodeAt","array","offset","transIndex","out","image","indexedPixels","colorDepth","colorTab","transparent","repeat","delay","started","usedEntry","palSize","dispose","closeStream","firstFrame","sizeSet","comment","reset","setDelay","ms","setDispose","setRepeat","iter","setTransparent","setComment","addFrame","im","is_imageData","Error","ok","ImageData","setSize","Uint8ClampedArray","console","log","getImagePixels","analyzePixels","writeLSD","writePalette","writeNetscapeExt","writeGraphicCtrlExt","writeCommentExt","writeImageDesc","writePixels","download","filename","endsWith","templink","href","URL","createObjectURL","Blob","Uint8Array","upload","replace","finish","setFrameRate","setQuality","quality","w","h","cont","nPix","nq","findClosest","minpos","dmin","dr","dg","db","d","transp","WriteShort","pValue","stream","setProperties","has_start","is_first","Uploader","UploaderForGoogleDrive","RetryHandler","interval","maxInterval","retry","fn","nextInterval_","getRandomInt_","random","MediaUploader","noop","file","contentType","metadata","mimeType","gapi","auth2","getAuthInstance","currentUser","getAuthResponse","access_token","onComplete","onProgress","onError","chunkSize","retryHandler","url","params","uploadType","buildUrl_","fileId","baseUrl","httpMethod","xhr","XMLHttpRequest","setRequestHeader","onload","status","location","getResponseHeader","sendFile_","onUploadError_","onerror","send","JSON","stringify","content","slice","addEventListener","onContentUploadSuccess_","onContentUploadError_","resume_","extractRange_","range","response","buildQuery_","keys","encodeURIComponent","query","saveAsGif","encoder","newArr","map2","every","toConsumableArray","fixedNewArray","from","newImage","uploadToUrl","binaryGif","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","isNaN","charAt","encode64","pUploaderForGoogleDrive","Promise","resolve","reject","parse","projectID","apikey","uploadToGoogle","client","setApiKey","load","then","err","error","drive","permissions","create","resource","getDate","Date","day","month","getMonth","hour","getHours","minutes","getMinutes","getFullYear","saveLocally","global","storage","dataUrl","date","piskel","localStorage","getItem","globalObj","idArr","project","localProjects","authLocalProjects","gifUrl","SaveOptions","isLogin","arrayFramesSrc","src","storageObj","objToSave","setItem","storedObj","storageEntries","entries","newstorage","authProjects","saveToGalery","defaultValue","rows","cols","saveLocallyHandler","saveToGaleryHandler","updateState","ExportOptions","showExportOptions","base64URL","win","heigh","debugBase64","rel","downloadPng","flex-direction","overflow","ancor","overflow-y","margin-bottom","border","flex-wrap","word-break","debugBase64WithText","ImportOptions","img","Options","fpsOnChangeHandler","layers_list_layers_list","palettes_palettes","menu_settings_settings","resizeCanvas","save_save","menu_export_export","menu_import_import","showOptionsOnClick","LocalSaves","changedProjects","obj","splice","projectsJson","cellPadding","cellSpacing","deletePiskel","addPiskel","CreateAnimation","showSaves","toolsDomBuilder","frameDomBuilder","canvasDomBuilder","previewDomBuilder","optionsDomBuilder","localSaves","User","isEmpty","localObj","backgroundImage","backgroundSize","alt","frame","makeRandomId","About","page","span","react_router","to","isRedirected","AppRouter","redirected","onSuccess","assertThisInitialized","init","client_id","signin2","render","scope","longtitle","onsuccess","onfailure","onFailure","googleUser","profile","getBasicProfile","ID","getId","fullName","getName","getImageUrl","getEmail","signOut","_this4","react_router_dom","confirm","preventDefault","addActiveClass","path","exact","component","Boolean","hostname","ReactDOM","mainpage_home","getElementById","navigator","serviceWorker","registration","unregister"],"mappings":"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","file":"static/js/main.1f82add3.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAOdJREFUOI3t0zErhWEUAOCnK9Pd76a4kjALGQ0+1ySrwXgXg9WPMBjFYJMSZTGom1kppJj9BBYZGL4zfG4ZvnPv6Cxv5z29T+e8dUbkYxK72EATL/huJLEC54FcoYNTpLwC79jpuz+Jbmtjd2ijh61KrYP9DNaKfAFfFXQbe1lsDg+Yx61y/HuMDYLNRN5W/mkxDKwV9TT2iNl/7M9YGybWxAcuMR3YU5y1MVjHIVZwg7dBMDjwe7F7mMpi8IrFSr6Kiyw2gWflBixhE0dqrFM1GtHNJ0ZxjGWcKce9rguKLroYzzzujx/AVUNl5zj/7wAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADCSURBVDhP7dAxCwFhGMDxh00Gk4nBYDAZFIvNJ/BBDOwGiUlJklAWPov4FqSUDEqUSfyf91zdqTuv3b9+3fte3b13j1hUwxpLJPWGTRHE0cLTYw6rGtjC+7BawVf0ff0sgYyz9GX1BW3cUMUG7un6O1/r4YKy2Ynk8cAeMb0RVhdnFM1OJIsdFqhDBxtYBXeUzE4khwMmCJqTrzGmzlIKOGKA0FPdUjihgz6uaMK6IXTK+pIZ3AFap9MdIW12/35M5AUsFCcIOdPfYQAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAEdSURBVEhL3dU/a8JAHMbxIChYlQ52aIeCU6Gbk2+hXcV306lDofSttIvuQsGhk4uLIIiCVVF0KxQ6td9HchDkvDvSdKgPfCC55H4PJP6Jjj4tPKOwO8s4ZSzxjTb+pKSODVTSwf8sKeIVKsi85ARdaPAa2/g4k5IKetBAvexr6HFlUnKKN2jQDFcw+fU7qaIPDZighv2kLjnDANo4wiUOJVXJC7RhiAsteJIsudeCK3l84RPnWghMAyqY7s4cyeEDujkNb4HyBNvmEN5HpOhF6YfNNsDFvORmzBndqA22QTZmeAnzmI6dCS1JfjzvYNZ17I2vJDlcGcNc03FQDpXY/oDeYa7r5yU4+n48YIEVHrE/XLmFBsuNFo4hUfQDRmuR/2vYwfIAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAWZJREFUOI2t0jFI1VEUx/FPGjlki9ai0CQIDQ5pCqbNTxJdykGdWmxxsUAHXYJwqMVBNHVzKWh2EAdBTDCQFhWKrMW2aFTiyXO4f+GP/u//8dQfHLiXe+73nvs7h2tWdYX5PZhDF6rwCyeXffwZVtCIZkxgHe9wv1LYIJZwM+OsDbOYjpxf0BBmcCMnpxa/0VEONoz5MrB7+IgDwdeoBgXDh3NymvAZvXiVB3uOIkpJ7OE1GlI5rVhFndD5OzFYAf9TsHScYAMfsIl6PBA6nqlW/IvAzmIL+7greLuI21mwGvzENhawjL8pUBHvsYPu5M5bPI5VN3qukgNMYQCTQpP2EiCM4WkMVoPDyBeLaE8eKGEcL9EXg8FIBHbWiBep/Tf058Gq8D0H+AWfkvWxMHO5epIDKwnGHyVRKAerxp/kYhtuZeR8xcOksrVywLTqBMN/pKrbFQa4sxJQlh7hjTCLLVeFXUmnRmtxEV/Efn8AAAAASUVORK5CYII=\"","import { createStore } from 'redux';\n\nfunction appState(state = {}, action) {\n  switch (action.type) {\n    case 'currentPage':\n      return Object.assign({}, state, {\n        currentPage: action.value\n      });\n    case 'currentColor':\n      return Object.assign({}, state, {\n        currentColor: action.value\n      });\n    case 'backColor':\n      return Object.assign({}, state, {\n        backColor: action.value\n      });\n    case 'currentTool':\n      return Object.assign({}, state, {\n        currentTool: action.value\n      });\n    case 'fps':\n      return Object.assign({}, state, {\n        fps: action.value\n      });\n    case 'customWidth':\n      return Object.assign({}, state, {\n        customWidth: action.value\n      });\n    default:\n      return state;\n  }\n}\n\nfunction settingsState(state = {}, action) {\n  switch (action.type) {\n    case 'setBg':\n      return Object.assign({}, state, {\n        setBg: action.value\n      });\n    case 'title':\n      return Object.assign({}, state, {\n        title: action.value\n      });\n    default:\n      return state;\n  }\n}\n\nfunction previewState(state = {}, action) {\n  switch (action.type) {\n    case 'gif':\n      return Object.assign({}, state, {\n        gif: action.value\n      });\n    case 'frames':\n      return Object.assign({}, state, {\n        frames: action.value\n      });\n    case 'piskelID':\n      return Object.assign({}, state, {\n        piskelID: action.value\n      });\n    case 'projects':\n      return Object.assign({}, state, {\n        projects: action.value\n      });\n    default:\n      return state;\n  }\n}\n\nfunction canvasState(state = {}, action) {\n  switch (action.type) {\n    case 'currentCanvas':\n      return Object.assign({}, state, {\n        currentCanvas: action.value\n      });\n    default:\n      return state;\n  }\n}\n\nfunction userState(state = {}, action) {\n  switch (action.type) {\n    case 'name':\n      return Object.assign({}, state, {\n        name: action.value\n      });\n    case 'userID':\n      return Object.assign({}, state, {\n        userID: action.value\n      });\n    case 'imageURL':\n      return Object.assign({}, state, {\n        imageURL: action.value\n      });\n    case 'email':\n      return Object.assign({}, state, {\n        email: action.value\n      });\n    case 'token':\n      return Object.assign({}, state, {\n        token: action.value\n      });\n    case 'googleUrl':\n      return Object.assign({}, state, {\n        googleUrl: action.value\n      });\n    case 'urlToGif':\n      return Object.assign({}, state, {\n        urlToGif: action.value\n      });\n    default:\n      return state;\n  }\n}\n\nfunction optionsState(state = {}, action) {\n  switch (action.type) {\n    case 'optionsBlock':\n      return Object.assign({}, state, {\n        optionsBlock: action.value\n      });\n    default:\n      return state;\n  }\n}\n\nfunction paletteState(state = {}, action) {\n  switch (action.type) {\n    case 'addColor':\n      return Object.assign({}, state, {\n        addColor: action.value\n      });\n    default:\n      return state;\n  }\n}\n\nconst preview = createStore(previewState);\nconst store = createStore(appState);\nconst settings = createStore(settingsState);\nconst canvas = createStore(canvasState);\nconst user = createStore(userState);\nconst options = createStore(optionsState);\nconst palette = createStore(paletteState);\n\nexport { store, settings, canvas, user, options, palette, preview };\n","import $ from 'jquery';\nimport colorPicker from './images/colorpicker.png';\nimport { store } from '../../store/store';\n\n// chose color from pop out panel of colors and bind it to current color box\nfunction customedColorOnChange(id) {\n  const newValue = $(`#${id}`).val();\n  const customedColor = `rgb(${$(`#${id}`)\n    .val()\n    .match(/[A-Za-z0-9]{2}/g)\n    .map(v => {\n      return parseInt(v, 16);\n    })\n    .join(', ')})`;\n  if (id === 'customed1') {\n    store.dispatch({ type: 'currentColor', value: customedColor });\n    $('#currentColor').css({ 'background-color': customedColor });\n  }\n  if (id === 'customed2') {\n    store.dispatch({ type: 'backColor', value: customedColor });\n    $('#backColor').css({ 'background-color': customedColor });\n  }\n\n  $(`#${id}`).attr('value', newValue);\n}\n\n// change style of tool button\nfunction colorPickerOnClick() {\n  if (store.getState().currentTool !== 'colorPickerTool') {\n    $('#palette-tool-area')\n      .find('button')\n      .removeClass('hovered');\n    $('#color-picker').addClass('hovered');\n    store.dispatch({ type: 'currentTool', value: 'colorPickerTool' });\n    $('#color-picker').focus();\n    $(document.body).css({ cursor: `url(${colorPicker}) 1 10, auto` });\n  } else if (store.getState().currentTool === 'colorPickerTool') {\n    store.dispatch({ type: 'currentTool', value: 'none' });\n    $('#color-picker').removeClass('hovered');\n    $('#color-picker').blur();\n    $(document.body).css({ cursor: 'default' });\n  }\n}\n\nfunction rgbaToHex(r, g, b) {\n  let hexR = r.toString(16);\n  let hexG = g.toString(16);\n  let hexB = b.toString(16);\n  if (hexR.length < 2) {\n    hexR = `0${hexR}`;\n  }\n  if (hexG.length < 2) {\n    hexG = `0${hexG}`;\n  }\n  if (hexB.length < 2) {\n    hexB = `0${hexB}`;\n  }\n  return `#${hexR}${hexG}${hexB}`;\n}\n\nfunction rgbToHex(color) {\n  const hex = `${color}`;\n\n  const nums = /(.*?)rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i.exec(hex);\n  const r = parseInt(nums[2], 10).toString(16);\n  const g = parseInt(nums[3], 10).toString(16);\n  const b = parseInt(nums[4], 10).toString(16);\n\n  return `#${r.length === 1 ? `0${r}` : r}${g.length === 1 ? `0${g}` : g}${\n    b.length === 1 ? `0${b}` : b\n  }`;\n}\n\nexport { customedColorOnChange, colorPickerOnClick, rgbaToHex, rgbToHex };\n","import React from 'react';\nimport $ from 'jquery';\nimport './tools.css';\nimport { colorPickerOnClick, customedColorOnChange, rgbaToHex, rgbToHex } from './color-picker';\nimport paintBucketOnClick from './paintBucket';\nimport penOnClick from './pen';\nimport eraserOnClick from './eraser';\nimport { strokeOnClick, rectangleOnClick, circleOnClick } from './stroke';\nimport { store, canvas } from '../../store/store';\n\nlet toolState;\nlet currentColorState;\nlet backColorState;\nstore.subscribe(() => {\n  toolState = store.getState().currentTool;\n  currentColorState = store.getState().currentColor;\n  backColorState = store.getState().backColor;\n});\nlet currentCanvas;\ncanvas.subscribe(() => {\n  currentCanvas = canvas.getState().currentCanvas;\n});\nclass Tools extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      tool: '',\n      active: '',\n      value1: '#161030',\n      value2: '#c0c0c0',\n      pickedColor: ''\n    };\n    this.mounted = false;\n  }\n\n  componentWillMount() {\n    $(document).click(e => this.colorPickerHandleClick(e));\n  }\n\n  componentDidMount() {\n    const currentColor = $('#currentColor').css('background-color');\n    const backColor = $('#backColor').css('background-color');\n    store.dispatch({ type: 'currentColor', value: currentColor });\n    store.dispatch({ type: 'backColor', value: backColor });\n    this.mounted = true;\n    if (this.mounted === true) {\n      this.setState({ pickedColor: currentColor });\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  switchColorsOnClick() {\n    store.dispatch({ type: 'currentColor', value: backColorState });\n    store.dispatch({ type: 'backColor', value: this.state.pickedColor });\n    const curColorValue = $('#customed1').val();\n    const backColorValue = $('#customed2').val();\n    $('#currentColor').css({ 'background-color': currentColorState });\n    $('#backColor').css({ 'background-color': backColorState });\n    this.setState({\n      value1: backColorValue,\n      value2: curColorValue,\n      pickedColor: currentColorState\n    });\n  }\n\n  colorPickerHandleClick(e) {\n    if (this.state.tool === 'colorPickerTool') {\n      if ($(e.target).is('.canvas')) {\n        const curCanv = document.querySelector(`#canvas${currentCanvas}`);\n        const rect = curCanv.getBoundingClientRect();\n        const x = Math.round(e.clientX - rect.left);\n        const y = Math.round(e.clientY - rect.top);\n        const ctx = curCanv.getContext('2d').getImageData(x, y, 1, 1).data;\n        const rgbColor = `rgba(${ctx[0]}, ${ctx[1]}, ${ctx[2]})`;\n        if (ctx[3] > 0) {\n          const hexColor = rgbaToHex(ctx[0], ctx[1], ctx[2]);\n          store.dispatch({ type: 'currentColor', value: rgbColor });\n          $('#currentColor').css({ 'background-color': rgbColor });\n          this.setState({\n            value1: hexColor,\n            pickedColor: rgbColor\n          });\n        }\n      }\n    }\n  }\n\n  buttonOnHoverIn(e) {\n    const id = $(e.target).attr('id');\n    if (this.mounted) {\n      this.setState({ active: id });\n    }\n  }\n\n  buttonOnHoverOut(e) {\n    $(e.target)\n      .children()\n      .removeClass('fas-hovered');\n    if (this.mounted) {\n      this.setState({ active: 'false' });\n    }\n  }\n\n  render() {\n    return (\n      <div name=\"Tools\">\n        <div className=\"palette\" id=\"palette-tool-area\">\n          <div className=\"palette-block\">\n            <button\n              id=\"paint-bucket\"\n              className=\"palette-button\"\n              type=\"button\"\n              onMouseEnter={e => this.buttonOnHoverIn(e)}\n              onMouseLeave={e => this.buttonOnHoverOut(e)}\n              onClick={() => {\n                paintBucketOnClick();\n                if (this.mounted) {\n                  this.setState({ tool: toolState });\n                }\n              }}\n            >\n              <i\n                className={`fas fa-fill-drip ${\n                  this.state.active === 'paint-bucket' ? 'fas-hovered' : ''\n                }`}\n              />\n            </button>\n          </div>\n          <div className=\"palette-block\">\n            <button\n              id=\"color-picker\"\n              className=\"palette-button\"\n              type=\"button\"\n              onMouseEnter={e => this.buttonOnHoverIn(e)}\n              onMouseLeave={e => this.buttonOnHoverOut(e)}\n              onClick={() => {\n                colorPickerOnClick();\n                if (this.mounted) {\n                  this.setState({ tool: toolState });\n                }\n              }}\n            >\n              <i\n                className={`fas fa-eye-dropper ${\n                  this.state.active === 'color-picker' ? 'fas-hovered' : ''\n                }`}\n              />\n            </button>\n          </div>\n          <div className=\"palette-block\">\n            <button\n              id=\"pen\"\n              className=\"palette-button\"\n              type=\"button\"\n              onMouseEnter={e => this.buttonOnHoverIn(e)}\n              onMouseLeave={e => this.buttonOnHoverOut(e)}\n              onClick={() => {\n                penOnClick();\n                if (this.mounted) {\n                  this.setState({ tool: toolState });\n                }\n              }}\n            >\n              <i\n                className={`fas fa-pencil-alt ${this.state.active === 'pen' ? 'fas-hovered' : ''}`}\n              />\n            </button>\n          </div>\n          <div className=\"palette-block\">\n            <button\n              id=\"eraser\"\n              className=\"palette-button\"\n              type=\"button\"\n              onMouseEnter={e => this.buttonOnHoverIn(e)}\n              onMouseLeave={e => this.buttonOnHoverOut(e)}\n              onClick={() => {\n                eraserOnClick();\n                if (this.mounted) {\n                  this.setState({ tool: toolState });\n                }\n              }}\n            >\n              <i\n                className={`fas fa-eraser ${this.state.active === 'eraser' ? 'fas-hovered' : ''}`}\n              />\n            </button>\n          </div>\n          <div className=\"palette-block\">\n            <button\n              id=\"stroke\"\n              className=\"palette-button\"\n              type=\"button\"\n              onMouseEnter={e => this.buttonOnHoverIn(e)}\n              onMouseLeave={e => this.buttonOnHoverOut(e)}\n              onClick={() => {\n                strokeOnClick();\n                if (this.mounted) {\n                  this.setState({ tool: toolState });\n                }\n              }}\n            >\n              <i\n                className={`fas fa-slash ${this.state.active === 'stroke' ? 'fas-hovered' : ''}`}\n              />\n            </button>\n          </div>\n          <div className=\"palette-block\">\n            <button\n              id=\"rectangle\"\n              className=\"palette-button\"\n              type=\"button\"\n              onMouseEnter={e => this.buttonOnHoverIn(e)}\n              onMouseLeave={e => this.buttonOnHoverOut(e)}\n              onClick={() => {\n                rectangleOnClick();\n                if (this.mounted) {\n                  this.setState({ tool: toolState });\n                }\n              }}\n            >\n              <i\n                className={`far fa-square ${\n                  this.state.active === 'rectangle' ? 'fas-hovered' : ''\n                }`}\n              />\n            </button>\n          </div>\n          <div className=\"palette-block\">\n            <button\n              id=\"circle\"\n              className=\"palette-button\"\n              type=\"button\"\n              onMouseEnter={e => this.buttonOnHoverIn(e)}\n              onMouseLeave={e => this.buttonOnHoverOut(e)}\n              onClick={() => {\n                circleOnClick();\n                if (this.mounted) {\n                  this.setState({ tool: toolState });\n                }\n              }}\n            >\n              <i\n                className={`far fa-circle ${this.state.active === 'circle' ? 'fas-hovered' : ''}`}\n              />\n            </button>\n          </div>\n        </div>\n\n        <div className=\"color\">\n          <div className=\"color-block hidden\">\n            <div className=\"radiobutton current\" id=\"currentColor\" />\n            <div className=\"radiobutton back\" id=\"backColor\" />\n            <button\n              type=\"button\"\n              id=\"switchHexValue\"\n              onClick={() => {\n                const hex = rgbToHex(currentColorState);\n                this.setState({ value1: hex });\n              }}\n            />\n          </div>\n          <div\n            className=\"switcher\"\n            role=\"button\"\n            onClick={() => this.switchColorsOnClick()}\n            onFocus={() => undefined}\n            onKeyPress={() => undefined}\n            tabIndex=\"-1\"\n          >\n            <i className=\"fas fa-retweet\" />\n          </div>\n          <div className=\"color-block-upper\">\n            <input\n              type=\"color\"\n              name=\"colors\"\n              className=\"input-color\"\n              id=\"customed1\"\n              value={this.state.value1}\n              onChange={() => {\n                customedColorOnChange('customed1');\n                this.setState({ value1: $('#customed1').val(), pickedColor: currentColorState });\n              }}\n            />\n          </div>\n          <div className=\"color-block-under\">\n            <input\n              type=\"color\"\n              name=\"colors\"\n              className=\"input-color\"\n              id=\"customed2\"\n              value={this.state.value2}\n              onChange={() => {\n                customedColorOnChange('customed2');\n                this.setState({ value2: $('#customed2').val() });\n              }}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Tools;\n","import $ from 'jquery';\n\nconst canvasWidth =\n  window.innerWidth - 500 < window.innerHeight - 155\n    ? window.innerWidth - 500\n    : window.innerHeight - 155;\nlet changeWidth;\n$(window).bind('resize', () => {\n  for (let i = 0; i < $('#canvas-block').children().length; i += 1) {\n    // get context before resizing\n    const imageData = $(`#canvas${i + 1}`)\n      .get(0)\n      .getContext('2d')\n      .getImageData(0, 0, canvasWidth, canvasWidth);\n\n    // calc new canvas width on resize the window\n    changeWidth =\n      window.innerWidth - 500 < window.innerHeight - 155\n        ? window.innerWidth - 500\n        : window.innerHeight - 155;\n\n    $(`#canvas${i + 1}`)\n      .attr('width', changeWidth)\n      .attr('height', changeWidth); // all canvases will resize\n\n    // put context after resizing\n    $(`#canvas${i + 1}`)\n      .get(0)\n      .getContext('2d')\n      .putImageData(imageData, 0, 0);\n  }\n  $('#drawCanvas')\n    .attr('width', changeWidth)\n    .attr('height', changeWidth);\n  $('#new-width').text($('#canvas1').width()); // change resize options\n  $('#resize-input').attr('max', $('#canvas1').width());\n});\n","import $ from 'jquery';\nimport { store } from '../../store/store';\nimport paintBucketIcon from './images/bucket.png';\n\n// change tool-button style, tool does not work yet\nexport default function paintBucketOnClick() {\n  if (store.getState().currentTool !== 'paintBucketTool') {\n    $('#palette-tool-area')\n      .find('button')\n      .removeClass('hovered');\n    $('#paint-bucket').addClass('hovered');\n    store.dispatch({ type: 'currentTool', value: 'paintBucketTool' });\n    $('#paint-bucket').focus();\n    $(document.body).css({ cursor: `url(${paintBucketIcon}) 15 15, auto` });\n  } else if (store.getState().currentTool === 'paintBucketTool') {\n    store.dispatch({ type: 'currentTool', value: '' });\n    $('#paint-bucket').removeClass('hovered');\n    $('#paint-bucket').blur();\n    $(document.body).css({ cursor: 'default' });\n  }\n}\n","import $ from 'jquery';\nimport './tools.css';\nimport { store } from '../../store/store';\nimport penIcon from './images/pen.png';\n\n// change button-tool style if clicked\nexport default function penOnClick() {\n  if (store.getState().currentTool !== 'penTool') {\n    $('#palette-tool-area')\n      .find('button')\n      .removeClass('hovered');\n    store.dispatch({ type: 'currentTool', value: 'penTool' });\n    $('#pen').addClass('hovered');\n    $('#pen').focus();\n    $(document.body).css({ cursor: `url(${penIcon}) 1 18, auto` });\n  } else if (store.getState().currentTool === 'penTool') {\n    store.dispatch({ type: 'currentTool', value: '' });\n    $('#pen').removeClass('hovered');\n    $('#pen').blur();\n    $(document.body).css({ cursor: 'default' });\n  }\n}\n","import $ from 'jquery';\nimport './tools.css';\nimport { store } from '../../store/store';\nimport erserIcon from './images/eraser.png';\n\n// change button-tool style if clicked\nexport default function eraserOnClick() {\n  if (store.getState().currentTool !== 'eraserTool') {\n    store.dispatch({ type: 'currentTool', value: 'eraserTool' });\n    $('#palette-tool-area')\n      .find('button')\n      .removeClass('hovered');\n    $('#eraser').addClass('hovered');\n    $('#eraser').focus();\n    $(document.body).css({ cursor: `url(${erserIcon}) 1 18, auto` });\n  } else if (store.getState().currentTool === 'eraserTool') {\n    store.dispatch({ type: 'currentTool', value: '' });\n    $('#eraser').removeClass('hovered');\n    $('#eraser').blur();\n    $(document.body).css({ cursor: 'default' });\n  }\n}\n","import $ from 'jquery';\nimport './tools.css';\nimport { store } from '../../store/store';\nimport penIcon from './images/pen.png';\n\n// change button-tool style if clicked\nfunction strokeOnClick() {\n  if (store.getState().currentTool !== 'strokeTool') {\n    store.dispatch({ type: 'currentTool', value: 'strokeTool' });\n    $('#palette-tool-area')\n      .find('button')\n      .removeClass('hovered');\n    $('#stroke').addClass('hovered');\n    $('#stroke').focus();\n    $(document.body).css({ cursor: `url(${penIcon}) 1 18, auto` });\n  } else if (store.getState().currentTool === 'strokeTool') {\n    store.dispatch({ type: 'currentTool', value: '' });\n    $('#stroke').removeClass('hovered');\n    $('#stroke').blur();\n    $(document.body).css({ cursor: 'default' });\n  }\n}\n\nfunction rectangleOnClick() {\n  if (store.getState().currentTool !== 'rectangleTool') {\n    store.dispatch({ type: 'currentTool', value: 'rectangleTool' });\n    $('#palette-tool-area')\n      .find('button')\n      .removeClass('hovered');\n    $('#rectangle').addClass('hovered');\n    $('#rectangle').focus();\n    $(document.body).css({ cursor: `url(${penIcon}) 1 18, auto` });\n  } else if (store.getState().currentTool === 'rectangleTool') {\n    store.dispatch({ type: 'currentTool', value: '' });\n    $('#rectangle').removeClass('hovered');\n    $('#rectangle').blur();\n    $(document.body).css({ cursor: 'default' });\n  }\n}\n\nfunction circleOnClick() {\n  if (store.getState().currentTool !== 'circleTool') {\n    store.dispatch({ type: 'currentTool', value: 'circleTool' });\n    $('#palette-tool-area')\n      .find('button')\n      .removeClass('hovered');\n    $('#circle').addClass('hovered');\n    $('#circle').focus();\n    $(document.body).css({ cursor: `url(${penIcon}) 1 18, auto` });\n  } else if (store.getState().currentTool === 'circleTool') {\n    store.dispatch({ type: 'currentTool', value: '' });\n    $('#circle').removeClass('hovered');\n    $('#circle').blur();\n    $(document.body).css({ cursor: 'default' });\n  }\n}\n\nexport { strokeOnClick, rectangleOnClick, circleOnClick };\n","import $ from 'jquery';\nimport { store, canvas, palette } from '../../store/store';\n\nlet currentCanvas;\nlet customWidth;\nlet tool;\ncanvas.subscribe(() => {\n  currentCanvas = canvas.getState().currentCanvas;\n});\nstore.subscribe(() => {\n  customWidth = store.getState().customWidth || 33;\n  tool = store.getState().currentTool;\n});\n\nlet endX;\nlet endY;\nlet mouseDownX;\nlet mouseDownY;\n\n// drawing on mouse move\nfunction end(e) {\n  const ctx = $(`#canvas${currentCanvas}`)\n    .get(0)\n    .getContext('2d');\n  endX = e.offsetX;\n  endY = e.offsetY;\n  if (tool === 'penTool') {\n    ctx.fillStyle = $('#currentColor').css('background-color'); // color depends on chosen color\n    ctx.strokeStyle = $('#currentColor').css('background-color');\n  } else if (tool === 'eraserTool') {\n    ctx.fillStyle = 'rgba(0, 0, 0, 1)';\n    ctx.strokeStyle = 'rgba(0, 0, 0, 1)';\n  }\n  // calc pen size according to chosen canvas width\n  const canvasSize = Math.ceil($(`#canvas${currentCanvas}`).width() / customWidth);\n  // calc position and size of canvas rectangles according to pen size\n  const mouseMoveX = Math.floor(e.offsetX / canvasSize) * canvasSize;\n  const mouseMoveY = Math.floor(e.offsetY / canvasSize) * canvasSize;\n  if (mouseDownX > endX || mouseDownY > endY) {\n    ctx.fillRect(mouseMoveX, mouseMoveY, canvasSize, canvasSize);\n  } else if (mouseDownX + canvasSize < endX || mouseDownY + canvasSize < endY) {\n    ctx.fillRect(mouseMoveX, mouseMoveY, canvasSize, canvasSize);\n  }\n}\n\n// drawing on mouse click\nfunction start(e) {\n  const canvasSize = Math.ceil($(`#canvas${currentCanvas}`).width() / customWidth);\n  mouseDownX = Math.floor(e.offsetX / canvasSize) * canvasSize;\n  mouseDownY = Math.floor(e.offsetY / canvasSize) * canvasSize;\n  if (tool === 'penTool' || tool === 'eraserTool') {\n    const ctx = $(`#canvas${currentCanvas}`)\n      .get(0)\n      .getContext('2d');\n    if (tool === 'penTool') {\n      ctx.globalCompositeOperation = 'source-over';\n      ctx.fillStyle = $('#currentColor').css('background-color');\n      ctx.strokeStyle = $('#currentColor').css('background-color');\n    } else if (tool === 'eraserTool') {\n      ctx.fillStyle = 'rgba(0, 0, 0, 1)';\n      ctx.strokeStyle = 'rgba(0, 0, 0, 1)';\n      ctx.globalCompositeOperation = 'destination-out';\n    }\n    ctx.fillRect(mouseDownX, mouseDownY, canvasSize, canvasSize);\n    $('#drawCanvas').mousemove(end);\n    palette.dispatch({ type: 'addColor', value: $('#currentColor').css('background-color') });\n    $('#addColorButton').click();\n  }\n}\n\nlet startX = 0;\nlet startY = 0;\nlet lastX = 0;\nlet lastY = 0;\nlet radius;\n\nfunction endStroke(e) {\n  let canvasSize = Math.ceil($(`#canvas${currentCanvas}`).width() / customWidth);\n  const drawCtx = $('#drawCanvas')\n    .get(0)\n    .getContext('2d');\n  const width = $('#drawCanvas').width();\n\n  lastX = e.pageX - this.offsetLeft;\n  lastY = e.pageY - this.offsetTop;\n  drawCtx.clearRect(0, 0, width, width);\n  drawCtx.globalCompositeOperation = 'source-over';\n  drawCtx.strokeStyle = $('#currentColor').css('background-color');\n  drawCtx.lineWidth = canvasSize;\n  drawCtx.beginPath();\n  if (tool === 'strokeTool') {\n    drawCtx.moveTo(startX, startY);\n    drawCtx.lineTo(lastX, lastY);\n    drawCtx.stroke();\n  } else if (tool === 'rectangleTool') {\n    drawCtx.moveTo(startX, startY);\n    drawCtx.lineTo(lastX, startY);\n    drawCtx.lineTo(lastX, lastY);\n    drawCtx.lineTo(startX, lastY);\n    drawCtx.lineTo(startX, startY);\n    drawCtx.stroke();\n  } else if (tool === 'circleTool') {\n    radius =\n      Math.sqrt((startX - lastX) * (startX - lastX) + (startY - lastY) * (startY - lastY)) / 2;\n    drawCtx.arc(startX, startY, radius, 0, 2 * Math.PI);\n    drawCtx.stroke();\n  }\n\n  $('#drawCanvas').mouseup(() => {\n    canvasSize = Math.ceil($(`#canvas${currentCanvas}`).width() / customWidth);\n    const ctx = $(`#canvas${currentCanvas}`)\n      .get(0)\n      .getContext('2d');\n    ctx.globalCompositeOperation = 'source-over';\n    ctx.strokeStyle = $('#currentColor').css('background-color');\n    ctx.lineWidth = canvasSize;\n    ctx.beginPath();\n    if (tool === 'strokeTool') {\n      ctx.moveTo(startX, startY);\n      ctx.lineTo(lastX, lastY);\n      ctx.stroke();\n      drawCtx.clearRect(0, 0, width, width);\n    } else if (tool === 'rectangleTool') {\n      ctx.moveTo(startX, startY);\n      ctx.lineTo(lastX, startY);\n      ctx.lineTo(lastX, lastY);\n      ctx.lineTo(startX, lastY);\n      ctx.lineTo(startX, startY);\n      ctx.stroke();\n      drawCtx.clearRect(0, 0, width, width);\n    } else if (tool === 'circleTool') {\n      ctx.arc(startX, startY, radius, 0, 2 * Math.PI);\n      ctx.stroke();\n      drawCtx.clearRect(0, 0, width, width);\n    }\n  });\n}\n\nfunction strokeLines(e) {\n  startX = e.pageX - this.offsetLeft;\n  startY = e.pageY - this.offsetTop;\n  $('#drawCanvas').mousemove(endStroke);\n  palette.dispatch({ type: 'addColor', value: $('#currentColor').css('background-color') });\n  $('#addColorButton').click();\n}\n\nexport { start, end, strokeLines };\n","import $ from 'jquery';\nimport { store, canvas, palette } from '../../store/store';\n\nlet currentCanvas;\ncanvas.subscribe(() => {\n  currentCanvas = canvas.getState().currentCanvas;\n});\n\nlet tool;\nstore.subscribe(() => {\n  tool = store.getState().currentTool;\n});\n\nfunction getColorAtPixel(imageData, x, y) {\n  const { width, data } = imageData;\n\n  return {\n    r: data[4 * (width * y + x) + 0],\n    g: data[4 * (width * y + x) + 1],\n    b: data[4 * (width * y + x) + 2],\n    a: data[4 * (width * y + x) + 3]\n  };\n}\n\nfunction setColorAtPixel(imageData, color, x, y) {\n  const { width, data } = imageData;\n\n  data[4 * (width * y + x) + 0] = color.r;\n  data[4 * (width * y + x) + 1] = color.g;\n  data[4 * (width * y + x) + 2] = color.b;\n  data[4 * (width * y + x) + 3] = color.a;\n}\nfunction colorMatch(a, b) {\n  return a.r === b.r && a.g === b.g && a.b === b.b && a.a === b.a;\n}\n\nfunction floodFill(imageData, newColor, x, y) {\n  const { width, height } = imageData;\n  const stack = [];\n  const baseColor = getColorAtPixel(imageData, x, y);\n  let clicked = { x, y };\n\n  // Check if base color and new color are the same\n  if (colorMatch(baseColor, newColor)) {\n    return;\n  }\n\n  // Add the clicked location to stack\n  stack.push({ x: clicked.x, y: clicked.y });\n\n  while (stack.length) {\n    clicked = stack.pop();\n    let goDown = true; // Vertical is assumed to be true\n    let goUp = true; // Vertical is assumed to be true\n    let goLeft = false;\n    let goRight = false;\n\n    // Move to top most goDown pixel\n    while (goUp && clicked.y >= 0) {\n      clicked.y -= 1;\n      goUp = colorMatch(getColorAtPixel(imageData, clicked.x, clicked.y), baseColor);\n    }\n\n    // Move downward\n    while (goDown && clicked.y < height) {\n      setColorAtPixel(imageData, newColor, clicked.x, clicked.y);\n\n      // Check left\n      if (\n        clicked.x - 1 >= 0 &&\n        colorMatch(getColorAtPixel(imageData, clicked.x - 1, clicked.y), baseColor)\n      ) {\n        if (!goLeft) {\n          goLeft = true;\n          stack.push({ x: clicked.x - 1, y: clicked.y });\n        }\n      } else {\n        goLeft = false;\n      }\n\n      // Check right\n      if (\n        clicked.x + 1 < width &&\n        colorMatch(getColorAtPixel(imageData, clicked.x + 1, clicked.y), baseColor)\n      ) {\n        if (!goRight) {\n          stack.push({ x: clicked.x + 1, y: clicked.y });\n          goRight = true;\n        }\n      } else {\n        goRight = false;\n      }\n\n      clicked.y += 1;\n      goDown = colorMatch(getColorAtPixel(imageData, clicked.x, clicked.y), baseColor);\n    }\n  }\n}\n\nexport default function paintIt(e) {\n  if (tool === 'paintBucketTool') {\n    const curCanv = document.querySelector(`#canvas${currentCanvas}`);\n    const ctx = curCanv.getContext('2d');\n    const newColor = $('#currentColor').css('background-color');\n    const rgb = newColor.match(/([0-9]+\\.?[0-9]*)/g);\n    const col = { r: +rgb[0], g: +rgb[1], b: +rgb[2], a: 255 };\n    ctx.fillStyle = newColor;\n    ctx.strokeStyle = newColor;\n    const rect = curCanv.getBoundingClientRect();\n    const x = Math.round(e.clientX - rect.left);\n    const y = Math.round(e.clientY - rect.top);\n    const imageData = ctx.getImageData(0, 0, curCanv.width, curCanv.height);\n    floodFill(imageData, col, x, y);\n    ctx.putImageData(imageData, 0, 0);\n\n    palette.dispatch({ type: 'addColor', value: $('#currentColor').css('background-color') });\n    $('#addColorButton').click();\n    // put canvas image in preview-box\n    const dataURL = $(`#canvas${currentCanvas}`)[0].toDataURL('image/png');\n\n    $(`#frame${currentCanvas}`)\n      .find('.preview-box')\n      .css({\n        background: `url(${dataURL})`,\n        'background-size': 'contain'\n      });\n  }\n}\n","import $ from 'jquery';\nimport { store } from '../../store/store';\n\nlet fps;\nstore.subscribe(() => {\n  fps = store.getState().fps || 3;\n});\nlet count = 0;\nlet anim;\nfunction animate() {\n  clearTimeout(anim); // stop old animation\n  const time = 1000 / fps; // calc animation speed\n  $('.preview')\n    .children()\n    .css({ display: 'none' }); // hide all canvas-images\n  if ($('.preview').children()[count]) {\n    $('.preview').children()[count].style.display = 'block'; // show only the \"count\"-th image\n  }\n  count += 1;\n  if (count === $('.preview').children().length) {\n    count = 0; // restart counting if all images were shown\n  }\n\n  anim = setTimeout(animate, time); // repeat animation\n}\n\n// make image from canvas drawing\nfunction makeImage(n) {\n  const canvasImage = new Image();\n  if ($(`#canvas${n}`)[0]) {\n    $(canvasImage)\n      .attr('id', `canvasImage${n}`)\n      .css({ width: '100%' })\n      .attr('src', $(`#canvas${n}`)[0].toDataURL('image/png'));\n  }\n  // if the image is from the same canvas should update the image\n  if ($(`#canvasImage${n}`).length) {\n    $(canvasImage)\n      .insertBefore(`#canvasImage${n}`)\n      .next()\n      .remove();\n  } else {\n    // if new canvas was made should append new image\n    $(canvasImage).appendTo('.preview');\n  }\n  if ($('.preview').children().length > 1) {\n    count = 0;\n    animate();\n  } else {\n    clearTimeout(anim);\n  }\n}\n\nlet newWindow;\nlet id = 0;\n// open new window to watch animation in full-size mode\nfunction fullSizePreview() {\n  if (newWindow) {\n    id += 1;\n    newWindow.close();\n  }\n  newWindow = window.open('about:blank', `window${id}`, 'width=300,height=300');\n\n  // cloning animation box with images to new window\n  const newPreview = $('.preview')\n    .clone()\n    .appendTo(newWindow.document.body)\n    .css({ display: 'flex', 'justify-content': 'center', 'align-items': 'center', height: '100%' });\n  $(newWindow.document.body).css({\n    display: 'flex',\n    'justify-content': 'center',\n    'align-items': 'center'\n  });\n\n  const newFps = fps;\n  let newCount = 0;\n\n  function newAnimate() {\n    // clearTimeout(newAnim);\n    const time = 1000 / newFps;\n    newPreview.children().css({ display: 'none' });\n    if (newPreview.children()[newCount]) {\n      newPreview.children()[newCount].style.display = 'block';\n    }\n    newCount += 1;\n    if (newCount === newPreview.children().length) {\n      newCount = 0;\n    }\n    setTimeout(newAnimate, time);\n  }\n  // when new window loaded should start animation\n  $(newWindow).ready(newAnimate);\n}\n\nexport { makeImage, animate, fullSizePreview };\n","import React from 'react';\nimport $ from 'jquery';\nimport './resizeWindow';\nimport './canvas.css';\nimport { canvas } from '../../store/store';\nimport { start, strokeLines } from './drawing';\nimport paintIt from './paint';\nimport { makeImage } from '../preview/preview';\n\nlet currentCanvas;\ncanvas.subscribe(() => {\n  currentCanvas = canvas.getState().currentCanvas;\n});\n\nclass Canvas extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      size: ''\n    };\n    this.mounted = false;\n  }\n\n  componentWillMount() {\n    const canvasWidth =\n      window.innerWidth - 500 < window.innerHeight - 155\n        ? window.innerWidth - 500\n        : window.innerHeight - 155;\n    this.setState({ size: canvasWidth });\n\n    $(document).click(() => this.penHandleClick());\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  penHandleClick() {\n    this.mounted = true;\n\n    // remove old events\n    $('#drawCanvas')\n      .unbind('mousedown')\n      .unbind('mouseup')\n      .unbind('click');\n    // initialize new events\n    $('#drawCanvas').click(paintIt);\n    $('#drawCanvas').mousedown(start);\n    $('#drawCanvas').mousedown(strokeLines);\n    $('#drawCanvas').mouseup(() => {\n      $('#drawCanvas').off('mousemove');\n      setTimeout(() => {\n        const dataURL = $(`#canvas${currentCanvas}`)[0].toDataURL('image/png');\n        // put canvas image in preview-box\n        $(`#frame${currentCanvas}`)\n          .find('.preview-box')\n          .css({\n            background: `url(${dataURL})`,\n            'background-size': 'contain'\n          });\n      }, 300);\n\n      // create image for animation preview\n      setTimeout(() => {\n        makeImage(currentCanvas);\n      }, 500);\n    });\n  }\n\n  render() {\n    return (\n      <div>\n        <div id=\"canvas-block\" className=\"canvas-block\">\n          <canvas\n            id=\"canvas1\"\n            className=\"canvas hidden\"\n            width={this.state.size}\n            height={this.state.size}\n          />\n        </div>\n        <canvas\n          id=\"drawCanvas\"\n          className=\"drawCanvas\"\n          width={this.state.size}\n          height={this.state.size}\n        />\n      </div>\n    );\n  }\n}\n\nexport default Canvas;\n","import React from 'react';\nimport $ from 'jquery';\nimport './frames.css';\nimport {\n  hoverIn,\n  hoverOut,\n  addNewFrame,\n  removeFrame,\n  copyFrame,\n  dragFrame,\n  dragOff\n} from './framesManager';\nimport { openCanvas } from './canvasManager';\nimport { store } from '../../store/store';\n\nlet customWidth;\nstore.subscribe(() => {\n  customWidth = store.getState().customWidth;\n});\n\nclass Frames extends React.Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n\n  componentDidMount() {\n    $('.frame')\n      .hover(hoverIn, hoverOut)\n      .click(openCanvas);\n    $('.removeFrame').click(removeFrame);\n    $('.copyFrame').click(copyFrame);\n    $('.dragFrame')\n      .mousedown(dragFrame)\n      .mouseup(dragOff);\n\n    // make the first frame active\n    $('#frame1')\n      .click(openCanvas)\n      .click();\n\n    // calculating canvas resize options\n    $('#current-width').text(customWidth);\n    $('#current-height').text(customWidth);\n    $('#new-width').text($('#canvas1').width());\n    $('#resize-input').attr('max', $('#canvas1').width());\n  }\n\n  render() {\n    return (\n      <div className=\"frame-box\">\n        <ul id=\"sortable\" className=\"frame-list\">\n          <li className=\"ui-state-default frame activeFrame\" id=\"frame1\">\n            <p id=\"preview-box\" className=\"preview-box\" />\n            <title className=\"number\">1</title>\n            <span className=\"removeFrame minorZ\">\n              <i className=\"fas fa-trash-alt\" />\n            </span>\n            <span className=\"dragFrame minorZ\">\n              <i className=\"fas fa-arrows-alt\" />\n            </span>\n            <span className=\"copyFrame minorZ\">\n              <i className=\"fas fa-copy\" />\n            </span>\n          </li>\n        </ul>\n        <button className=\"addNewFrame\" onClick={addNewFrame} type=\"button\">\n          Add new frame\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default Frames;\n","import $ from 'jquery';\nimport { makeImage } from '../../screens/preview/preview';\nimport { canvas } from '../../store/store';\n\n// show canvas according to active frame, hide other canvas\nfunction openCanvas() {\n  const num = $(this)\n    .find('.number')\n    .text(); // calc target frame ID\n  canvas.dispatch({ type: 'currentCanvas', value: +num });\n  $('.canvas').addClass('hidden'); // hide all canvas\n  $(`#canvas${num}`).removeClass('hidden'); // show current canvas\n  if ($('.activeFrame')) {\n    $('.activeFrame').removeClass('activeFrame');\n  }\n  $(this).toggleClass('activeFrame'); // make current frame active\n  setTimeout(() => {\n    makeImage(+num); // automatically make image of current canvas for animation\n  }, 200);\n}\n\n// create new canvas if new frame was created\nfunction newCanvas(n) {\n  const canvasWidth =\n    window.innerWidth - 500 < window.innerHeight - 155\n      ? window.innerWidth - 500\n      : window.innerHeight - 155;\n  const newCanvasEl = $('<canvas/>', {\n    class: 'canvas hidden',\n    id: `canvas${n}`\n  })\n    .attr('width', canvasWidth)\n    .attr('height', canvasWidth);\n  newCanvasEl.appendTo('#canvas-block');\n}\n\n// copy target frame's canvas with content if the frame was cloned\nfunction copyCanvas(n) {\n  const cloneWrapper = $(`#canvas${n}`)\n    .clone()\n    .attr('id', `canvas${+n + 1}`)\n    .attr('width', $(`#canvas${n}`).width())\n    .attr('height', $(`#canvas${n}`).width())\n    .insertAfter(`#canvas${n}`);\n  const originalContext = $(`#canvas${n}`)\n    .get(0)\n    .getContext('2d');\n  const imageData = originalContext.getImageData(\n    0,\n    0,\n    $(`#canvas${n}`).width(),\n    $(`#canvas${n}`).width()\n  );\n  const cloneContext = cloneWrapper.get(0).getContext('2d');\n  cloneContext.putImageData(imageData, 0, 0);\n}\nfunction copyCanvasContext(n) {\n  const originalContext = $(`#canvas${n}`)\n    .get(0)\n    .getContext('2d');\n  const imageData = originalContext.getImageData(\n    0,\n    0,\n    $(`#canvas${n}`).width(),\n    $(`#canvas${n}`).width()\n  );\n  return imageData;\n}\n\nfunction putImage(n, imageData) {\n  const cloneContext = $(`#canvas${n}`)\n    .get(0)\n    .getContext('2d');\n  cloneContext.putImageData(imageData, 0, 0);\n}\n\nexport { copyCanvas, newCanvas, openCanvas, copyCanvasContext, putImage };\n","import $ from 'jquery';\nimport 'jquery-ui-sortable-npm';\nimport { makeImage } from '../../screens/preview/preview';\nimport { openCanvas, newCanvas, copyCanvas } from './canvasManager';\n\n// show/hide frame buttons\nfunction hoverIn() {\n  const children = $(this).find('span');\n  if (children.hasClass('minorZ')) {\n    children.removeClass('minorZ');\n    if ($('#sortable').children().length === 1) {\n      $('#frame1')\n        .find('.removeFrame')\n        .addClass('minorZ');\n      $('#frame1')\n        .find('.dragFrame')\n        .addClass('minorZ');\n    }\n  }\n}\nfunction hoverOut() {\n  const children = $(this).find('span');\n  if (!children.hasClass('minorZ')) {\n    children.addClass('minorZ');\n  }\n  if ($('#sortable').children().length === 1) {\n    $('#frame1')\n      .find('.copyFrame')\n      .addClass('minorZ');\n    $('#frame1')\n      .find('.dragFrame')\n      .addClass('minorZ');\n  }\n}\n// update IDs after adding/removing elements\nfunction updateId() {\n  for (let i = 0; i < $('#canvas-block').children().length; i += 1) {\n    $('#canvas-block').children()[i].id = `canvas${i + 1}`;\n  }\n  for (let i = 0; i < $('.preview').children().length; i += 1) {\n    $('.preview').children()[i].id = `canvasImage${i + 1}`;\n  }\n  for (let i = 0; i < $('#sortable').children().length; i += 1) {\n    $('#sortable').children()[i].id = `frame${i + 1}`;\n    const child = $($('#sortable').children()[i]);\n    child.find('.number').text(i + 1);\n    makeImage(i + 1);\n  }\n}\n\nfunction dragFrame() {\n  $('#sortable').sortable();\n  $('#sortable').sortable('option', 'disabled', false);\n  $('#sortable').disableSelection();\n}\n\nfunction dragOff(e) {\n  $('#sortable').sortable('option', 'disabled', true);\n  setTimeout(() => {\n    const dragged = $(e.currentTarget)\n      .parent()\n      .find('.number')\n      .text();\n    updateId();\n    const target = $(e.currentTarget)\n      .parent()\n      .find('.number')\n      .text();\n    if (dragged < target) {\n      $(`#canvas${dragged}`).insertAfter(`#canvas${target}`);\n    } else {\n      $(`#canvas${dragged}`).insertBefore(`#canvas${target}`);\n    }\n    // const draggedImage = copyCanvasContext(dragged);\n    // const targetImage = copyCanvasContext(dragged + 1);\n    // putImage(dragged, targetImage);\n    // putImage(target, draggedImage);\n    updateId();\n  }, 200);\n  setTimeout(() => {\n    $(e.currentTarget)\n      .parent()\n      .click();\n  }, 400);\n}\n\nfunction removeFrame() {\n  // calculating target's ID\n  const num = $(this)\n    .parent()\n    .find('.number')\n    .text();\n  // remove all related elements\n  $(`#frame${num}`).remove();\n  $(`#canvasImage${num}`).remove();\n  $(`#canvas${num}`).remove();\n  updateId();\n  $(`#frame${+num - 1}`).click(); // make previous frame active\n}\n\nfunction copyFrame() {\n  // calculating target's ID\n  const num = $(this)\n    .parent()\n    .find('.number')\n    .text();\n  // cloning target frame\n  $(`#frame${num}`)\n    .clone()\n    .insertAfter(`#frame${num}`)\n    .attr('id', `frame${+num + 1}`)\n    .removeClass('activeFrame')\n    .hover(hoverIn, hoverOut)\n    .click(openCanvas);\n  // cloning target canvas image\n  copyCanvas(num);\n  // bind frame events\n  $(`#frame${+num + 1}`)\n    .find('.removeFrame')\n    .click(removeFrame);\n  $(`#frame${+num + 1}`)\n    .find('.copyFrame')\n    .click(copyFrame);\n  $(`#frame${+num + 1}`)\n    .find('.dragFrame')\n    .mousedown(dragFrame)\n    .mouseup(dragOff);\n  // make copied frame active\n  setTimeout(() => {\n    $(`#frame${+num + 1}`).click();\n  }, 100);\n  updateId();\n  // cloning target frame preview image\n  const dataURL = $(`#canvas${num}`)[0].toDataURL('image/png');\n  if (dataURL) {\n    $(`#frame${+num + 1}`)\n      .find('.preview-box')\n      .css({\n        background: `url(${dataURL})`,\n        'background-size': 'contain'\n      });\n  }\n  // update frame images and animation\n  for (let i = 0; i < $('.frame-list').children().length; i += 1) {\n    makeImage(i + 1);\n  }\n}\n\nfunction addNewFrame() {\n  const count = $('.frame-list').children().length + 1; // calc ID for new frame\n  $('.frame')\n    .first()\n    .clone()\n    .appendTo('.frame-list')\n    .attr('id', `frame${count}`)\n    .removeClass('activeFrame')\n    .hover(hoverIn, hoverOut)\n    .click(openCanvas)\n    .find('.preview-box')\n    .css({ background: 'none' }); // clear preview-box background from first frame\n  $('.number')\n    .last()\n    .text(count); // update number of frame\n  newCanvas(count);\n  $(`#frame${count}`)\n    .find('.removeFrame')\n    .click(removeFrame);\n  $(`#frame${count}`)\n    .find('.copyFrame')\n    .click(copyFrame);\n  $(`#frame${count}`)\n    .find('.dragFrame')\n    .mousedown(dragFrame)\n    .mouseup(dragOff);\n  setTimeout(() => {\n    $(`#frame${count}`).click(); // make new frame active\n  }, 100);\n}\n\nexport { hoverIn, hoverOut, addNewFrame, removeFrame, copyFrame, dragFrame, dragOff, updateId };\n","import React from 'react';\nimport $ from 'jquery';\nimport './palettes.css';\nimport { palette, store } from '../../../store/store';\n\nlet newColor;\npalette.subscribe(() => {\n  newColor = palette.getState().addColor;\n});\n\nclass Palettes extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      hovered: '',\n      mouseEnter: false,\n      color: [],\n      changed: false,\n      active: ''\n    };\n  }\n\n  popHintOnMouseOver(e) {\n    const hovered = e.target.getAttribute('id');\n    if (this.state.hovered === hovered) {\n      this.setState({ hovered: '' });\n    } else {\n      this.setState({ hovered });\n    }\n  }\n\n  mouseIn() {\n    this.setState({ mouseEnter: true });\n  }\n\n  mouseOut() {\n    this.setState({ mouseEnter: false });\n  }\n\n  addNewColor() {\n    if (this.state.color.indexOf(newColor) === -1) {\n      this.state.color.push(newColor);\n      this.setState({ changed: true, active: newColor });\n    }\n  }\n\n  changeCurColor(e) {\n    const color = $(e.target).css('background-color');\n    this.setState({ active: color });\n    $('#currentColor').css({ background: color });\n    store.dispatch({ type: 'currentColor', value: color });\n    $('#switchHexValue').click();\n  }\n\n  render() {\n    return (\n      <div\n        className=\"palettes-box\"\n        onMouseOver={e => this.popHintOnMouseOver(e)}\n        onFocus={() => undefined}\n      >\n        <div className=\"palettes-outlet\">\n          <span className=\"palettes-title\">Palettes</span>\n        </div>\n        <div className=\"palettes-buttons-box\">\n          <button\n            type=\"button\"\n            className=\"palettes-button\"\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i id=\"palettes-plus\" className=\"fas fa-plus\" />\n          </button>\n          <button type=\"button\" id=\"palettes-dropdown-list\" className=\"palettes-button colors-list\">\n            Current colors\n            <i\n              className={`colors-list-arrow fas fa-sort-down ${\n                this.state.hovered === 'palettes-dropdown-list' ? 'colors-list-arrow-hovered' : ''\n              }`}\n            />\n          </button>\n          <button\n            type=\"button\"\n            className=\"palettes-button\"\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i id=\"palettes-edit\" className=\"fas fa-pen\" />\n          </button>\n          <p\n            className={`hint palettes-plus ${\n              this.state.mouseEnter === true && this.state.hovered === 'palettes-plus'\n                ? ''\n                : 'hidden'\n            }`}\n          >\n            Create a new palette\n            <i className=\"palettes-plus-arrow fas fa-sort-down\" />\n          </p>\n          <p\n            className={`hint palettes-edit ${\n              this.state.mouseEnter === true && this.state.hovered === 'palettes-edit'\n                ? ''\n                : 'hidden'\n            }`}\n          >\n            Palette options\n            <i className=\"palettes-edit-arrow fas fa-sort-down\" />\n          </p>\n        </div>\n        <ul className=\"palettes-list\">\n          <span className={`palette-colors-isempty ${this.state.changed === true ? 'hidden' : ''}`}>\n            No colors in this palette yet\n          </span>\n          {this.state.color.map(item => (\n            <li key={item} id={item} className=\"palette-sample-list\">\n              <div\n                style={{ background: item }}\n                className={`palette-sample ${\n                  this.state.active === item ? 'active-palette-sample' : ''\n                }`}\n                onClick={e => this.changeCurColor(e)}\n                tabIndex=\"-1\"\n                onKeyPress={() => undefined}\n                onFocus={() => undefined}\n                role=\"button\"\n              />\n            </li>\n          ))}\n        </ul>\n        <button\n          id=\"addColorButton\"\n          className=\"hidden\"\n          type=\"button\"\n          onClick={() => this.addNewColor()}\n        />\n      </div>\n    );\n  }\n}\n\nexport default Palettes;\n","import React from 'react';\nimport './preview.css';\nimport { fullSizePreview } from './preview';\n\nclass Preview extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      active: ''\n    };\n    this.mounted = false;\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  hoverIn() {\n    if (this.mounted) {\n      this.setState({ active: true });\n    }\n  }\n\n  hoverOut() {\n    if (this.mounted) {\n      this.setState({ active: false });\n    }\n  }\n\n  render() {\n    return (\n      <div\n        id=\"preview-area\"\n        className=\"preview-area\"\n        onMouseEnter={() => this.hoverIn()}\n        onMouseLeave={() => this.hoverOut()}\n      >\n        <div\n          className={`preview-open ${this.state.active ? '' : 'hidden'}`}\n          id=\"preview-open\"\n          role=\"button\"\n          tabIndex=\"-1\"\n          onKeyPress={undefined}\n          onClick={fullSizePreview} // open animation in full size mode\n        >\n          <i className=\"fas fa-external-link-alt\" />\n        </div>\n        <div className=\"preview\" />\n      </div>\n    );\n  }\n}\n\nexport default Preview;\n","import React from 'react';\nimport './layers-list.css';\n\nclass Layers extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      hovered: '',\n      mouseEnter: false\n    };\n  }\n\n  popHintOnMouseOver(e) {\n    const hovered = e.target.getAttribute('id');\n    if (this.state.hovered === hovered) {\n      this.setState({ hovered: '' });\n    } else {\n      this.setState({ hovered });\n    }\n  }\n\n  mouseIn() {\n    this.setState({ mouseEnter: true });\n  }\n\n  mouseOut() {\n    this.setState({ mouseEnter: false });\n  }\n\n  render() {\n    return (\n      <div\n        className=\"layers-box\"\n        onMouseOver={e => this.popHintOnMouseOver(e)}\n        onFocus={() => undefined}\n      >\n        <div className=\"layer-outlet\">\n          <span className=\"layer-title\">Layers</span>\n          <i\n            id=\"layers-preview\"\n            className=\"fas fa-eye\"\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          />\n          <p\n            className={`hint layers-preview ${\n              this.state.hovered === 'layers-preview' ? '' : 'hidden'\n            }`}\n          >\n            Preview all layers\n            <i className=\"layers-preview-arrow fas fa-sort-down\" />\n          </p>\n        </div>\n        <div className=\"layer-buttons-box\">\n          <button\n            type=\"button\"\n            className=\"layer-button\"\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i id=\"layers-plus\" className=\"fas fa-plus\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"layer-button\"\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i id=\"layers-up\" className=\"fas fa-arrow-up\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"layer-button\"\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i id=\"layers-down\" className=\"fas fa-arrow-down\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"layer-button\"\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i id=\"layers-edit-name\" className=\"fas fa-pen\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"layer-button\"\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i id=\"layers-merge\" className=\"fas fa-compress\" />\n          </button>\n          <button\n            type=\"button\"\n            className=\"layer-button\"\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i id=\"layers-remove\" className=\"fas fa-times\" />\n          </button>\n          <p\n            className={`hint layers-plus ${\n              this.state.mouseEnter === true && this.state.hovered === 'layers-plus' ? '' : 'hidden'\n            }`}\n          >\n            Create a layer\n            <i className=\"layers-plus-arrow fas fa-sort-down\" />\n          </p>\n          <p\n            className={`hint layers-up ${\n              this.state.mouseEnter === true && this.state.hovered === 'layers-up' ? '' : 'hidden'\n            }`}\n          >\n            Move layer up\n            <i className=\"layers-up-arrow fas fa-sort-down\" />\n          </p>\n          <p\n            className={`hint layers-down ${\n              this.state.mouseEnter === true && this.state.hovered === 'layers-down' ? '' : 'hidden'\n            }`}\n          >\n            Move layer down\n            <i className=\"layers-down-arrow fas fa-sort-down\" />\n          </p>\n          <p\n            className={`hint layers-edit-name ${\n              this.state.mouseEnter === true && this.state.hovered === 'layers-edit-name'\n                ? ''\n                : 'hidden'\n            }`}\n          >\n            Edit layer name\n            <i className=\"layers-edit-name-arrow fas fa-sort-down\" />\n          </p>\n          <p\n            className={`big hint layers-merge ${\n              this.state.mouseEnter === true && this.state.hovered === 'layers-merge'\n                ? ''\n                : 'hidden'\n            }`}\n          >\n            Merge with layer below\n            <i className=\"layers-merge-arrow fas fa-sort-down\" />\n          </p>\n          <p\n            className={`big hint layers-remove ${\n              this.state.mouseEnter === true && this.state.hovered === 'layers-remove'\n                ? ''\n                : 'hidden'\n            }`}\n          >\n            Delete selected layer\n            <i className=\"layers-remove-arrow fas fa-sort-down\" />\n          </p>\n        </div>\n        <ul className=\"layer-list\">\n          <li className=\"layer-item\">Layer 1</li>\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default Layers;\n","import React from 'react';\nimport $ from 'jquery';\nimport './settings.css';\nimport { options } from '../../../store/store';\n\n// let customWidth;\nlet optionsBlock;\noptions.subscribe(() => {\n  // customWidth = store.getState().customWidth || 33;\n  optionsBlock = options.getState().optionsBlock;\n});\n\nfunction setBG(background) {\n  $('.frame').css({ background });\n  $('.canvas').css({ background });\n}\nclass Settings extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      active: ''\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  addActiveOnClick(e) {\n    const clicked = e.target.getAttribute('id');\n    const bg = $(e.target).css('background-image');\n    setBG(bg);\n    this.setState({ active: clicked });\n  }\n\n  render() {\n    return (\n      <div\n        className={`general-settings-block ${optionsBlock === 'settings' ? 'flexed' : 'hidden'}`}\n      >\n        <div className=\"current-bg\">\n          <span className=\"default-bg bold\">Background</span>\n          <div className=\"general-settings-buttons-area\">\n            <button\n              type=\"button\"\n              id=\"bg1\"\n              onClick={e => this.addActiveOnClick(e)}\n              className={`general-settings-button bg1 ${\n                this.state.active === 'bg1' ? 'active-button' : 'not-active-button'\n              }`}\n            />\n            <button\n              type=\"button\"\n              id=\"bg2\"\n              onClick={e => this.addActiveOnClick(e)}\n              className={`general-settings-button bg2 ${\n                this.state.active === 'bg2' ? 'active-button' : 'not-active-button'\n              }`}\n            />\n            <button\n              type=\"button\"\n              id=\"bg3\"\n              onClick={e => this.addActiveOnClick(e)}\n              className={`general-settings-button bg3 ${\n                this.state.active === 'bg3' ? 'active-button' : 'not-active-button'\n              }`}\n            />\n            <button\n              type=\"button\"\n              id=\"bg4\"\n              onClick={e => this.addActiveOnClick(e)}\n              className={`general-settings-button bg4 ${\n                this.state.active === 'bg4' ? 'active-button' : 'not-active-button'\n              }`}\n            />\n          </div>\n          <p>Set default background</p>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Settings;\n","import React from 'react';\nimport $ from 'jquery';\nimport './resize.css';\nimport { store, options } from '../../../store/store';\n\nlet customWidth;\nlet optionsBlock;\nstore.subscribe(() => {\n  customWidth = store.getState().customWidth || 33;\n});\noptions.subscribe(() => {\n  optionsBlock = options.getState().optionsBlock;\n});\nclass ResizeCanvas extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      customWidth: ''\n    };\n  }\n\n  componentDidMount() {\n    // calculating canvas resize options\n    $('#current-width').text(customWidth);\n    $('#current-height').text(customWidth);\n    $('#new-width').text($('#canvas1').width());\n    $('#resize-input').attr('max', `${$('#canvas1').width()}`);\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  resizeCanvasOnClickHandler() {\n    if ($('#resize-input').val()) {\n      const inputVal = +$('#resize-input').val();\n      const maxSize = +$('#resize-input').attr('max');\n      if (inputVal > 0 && inputVal < maxSize) {\n        store.dispatch({ type: 'customWidth', value: inputVal });\n        if (this.mounted) {\n          this.setState({ customWidth });\n        }\n        $('#resize-input').val('');\n        $('#error-message').text('');\n      } else {\n        $('#error-message').text(\n          `Size can be from ${$('#resize-input').attr('min')} to ${$('#resize-input').attr(\n            'max'\n          )} px`\n        );\n        $('#resize-input').val('');\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className={`resize-canvas-block ${\n          optionsBlock === 'resize-settings' ? 'flexed' : 'hidden'\n        }`}\n      >\n        <div className=\"current-size\">\n          <span className=\"default-size bold\">current size</span>\n          <p>\n            {`Width `}\n            <span className=\"default-width bold\" id=\"current-width\">\n              {this.state.customWidth}\n            </span>\n            px\n          </p>\n          <p>\n            Height\n            <span className=\"default-width bold\" id=\"current-height\">\n              {this.state.customWidth}\n            </span>\n            px\n          </p>\n        </div>\n        <div className=\"resize-canvas\">\n          <span className=\"resize bold\">resize</span>\n          <p className=\"new-width-block\">\n            <span>1 - </span>\n            <span id=\"new-width\" className=\"canvas-width\" />\n            <span>px</span>\n            <input\n              type=\"number\"\n              className=\"resize-input\"\n              id=\"resize-input\"\n              min=\"1\"\n              onKeyPress={e => {\n                if (e.key === 'Enter') {\n                  this.resizeCanvasOnClickHandler();\n                }\n              }}\n            />\n          </p>\n          <p id=\"error-message\" className=\"error-message\" />\n          <button\n            id=\"resize-button\"\n            className=\"resize-button\"\n            type=\"button\"\n            onClick={() => this.resizeCanvasOnClickHandler()}\n          >\n            Change canvas size\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ResizeCanvas;\n","/* eslint-disable import/prefer-default-export */\n/* eslint-disable prettier/prettier */\n/* eslint-disable func-names */\n/* eslint-disable no-bitwise */\n/* eslint-disable prefer-rest-params */\n/* eslint-disable no-empty */\n/* eslint-disable no-var */\n/* eslint-disable no-use-before-define */\n/* eslint-disable no-lonely-if */\n/* eslint-disable eqeqeq */\n/* eslint-disable no-plusplus */\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-multi-assign */\n/* eslint-disable no-shadow */\n/* eslint-disable prefer-const */\n/*\n * NeuQuant Neural-Net Quantization Algorithm\n * ------------------------------------------\n *\n * Copyright (c) 1994 Anthony Dekker\n *\n * NEUQUANT Neural-Net quantization algorithm by Anthony Dekker, 1994. See\n * \"Kohonen neural networks for optimal colour quantization\" in \"Network:\n * Computation in Neural Systems\" Vol. 5 (1994) pp 351-367. for a discussion of\n * the algorithm.\n *\n * Any party obtaining a copy of these files from the author, directly or\n * indirectly, is granted, free of charge, a full and unrestricted irrevocable,\n * world-wide, paid up, royalty-free, nonexclusive right and license to deal in\n * this software and documentation files (the \"Software\"), including without\n * limitation the rights to use, copy, modify, merge, publish, distribute,\n * sublicense, and/or sell copies of the Software, and to permit persons who\n * receive copies from any such party to do so, with the only requirement being\n * that this copyright notice remain intact.\n */\n\n/*\n * This class handles Neural-Net quantization algorithm\n * @author Kevin Weiner (original Java version - kweiner@fmsware.com)\n * @author Thibault Imbert (AS3 version - bytearray.org)\n * @author Kevin Kwok (JavaScript version - https://github.com/antimatter15/jsgif)\n * @version 0.1 AS3 implementation\n */\n\nconst NeuQuant = function () {\n  let exports = {};\n  let netsize = 256; /* number of colours used */\n\n  /* four primes near 500 - assume no image has a length so large */\n  /* that it is divisible by all four primes */\n\n  let prime1 = 499;\n  let prime2 = 491;\n  let prime3 = 487;\n  let prime4 = 503;\n  let minpicturebytes = 3 * prime4; /* minimum size for input image */\n\n  /*\n   * Program Skeleton ---------------- [select samplefac in range 1..30] [read\n   * image from input file] pic = (unsigned char*) malloc(3*width*height);\n   * initnet(pic,3*width*height,samplefac); learn(); unbiasnet(); [write output\n   * image header, using writecolourmap(f)] inxbuild(); write output image using\n   * inxsearch(b,g,r)\n   */\n\n  /*\n   * Network Definitions -------------------\n   */\n\n  let maxnetpos = netsize - 1;\n  let netbiasshift = 4; /* bias for colour values */\n  let ncycles = 100; /* no. of learning cycles */\n\n  /* defs for freq and bias */\n  let intbiasshift = 16; /* bias for fractions */\n  let intbias = 1 << intbiasshift;\n  let gammashift = 10; /* gamma = 1024 */\n  let gamma = 1 << gammashift;\n  let betashift = 10;\n  let beta = intbias >> betashift; /* beta = 1/1024 */\n  let betagamma = intbias << (gammashift - betashift);\n\n  /* defs for decreasing radius factor */\n  let initrad = netsize >> 3; /* for 256 cols, radius starts */\n  let radiusbiasshift = 6; /* at 32.0 biased by 6 bits */\n  let radiusbias = 1 << radiusbiasshift;\n  let initradius = initrad * radiusbias; /* and decreases by a */\n  let radiusdec = 30; /* factor of 1/30 each cycle */\n\n  /* defs for decreasing alpha factor */\n  let alphabiasshift = 10; /* alpha starts at 1.0 */\n  let initalpha = 1 << alphabiasshift;\n  let alphadec; /* biased by 10 bits */\n\n  /* radbias and alpharadbias used for radpower calculation */\n  let radbiasshift = 8;\n  let radbias = 1 << radbiasshift;\n  let alpharadbshift = alphabiasshift + radbiasshift;\n  let alpharadbias = 1 << alpharadbshift;\n\n  /*\n   * Types and Global Variables --------------------------\n   */\n\n  let thepicture; /* the input image itself */\n  let lengthcount; /* lengthcount = H*W*3 */\n  let samplefac; /* sampling factor 1..30 */\n\n  // typedef int pixel[4]; /* BGRc */\n  let network; /* the network itself - [netsize][4] */\n  let netindex = [];\n\n  /* for network lookup - really 256 */\n  let bias = [];\n\n  /* bias and freq arrays for learning */\n  let freq = [];\n  let radpower = [];\n\n  let NeuQuant = (exports.NeuQuant = function NeuQuant(thepic, len, sample) {\n    let i;\n    let p;\n\n    thepicture = thepic;\n    lengthcount = len;\n    samplefac = sample;\n\n    network = new Array(netsize);\n\n    for (i = 0; i < netsize; i++) {\n      network[i] = new Array(4);\n      p = network[i];\n      p[0] = p[1] = p[2] = (i << (netbiasshift + 8)) / netsize;\n      freq[i] = intbias / netsize; /* 1/netsize */\n      bias[i] = 0;\n    }\n  });\n\n  let colorMap = function colorMap() {\n    let map = [];\n    let index = new Array(netsize);\n\n    for (let i = 0; i < netsize; i++) index[network[i][3]] = i;\n\n    let k = 0;\n    for (let l = 0; l < netsize; l++) {\n      let j = index[l];\n      map[k++] = network[j][0];\n      map[k++] = network[j][1];\n      map[k++] = network[j][2];\n    }\n\n    return map;\n  };\n\n  /*\n   * Insertion sort of network and building of netindex[0..255] (to do after\n   * unbias)\n   * -------------------------------------------------------------------------------\n   */\n\n  let inxbuild = function inxbuild() {\n    let i;\n    let j;\n    let smallpos;\n    let smallval;\n    let p;\n    let q;\n    let previouscol;\n    let startpos;\n\n    previouscol = 0;\n    startpos = 0;\n    for (i = 0; i < netsize; i++) {\n      p = network[i];\n      smallpos = i;\n      smallval = p[1]; /* index on g */\n\n      /* find smallest in i..netsize-1 */\n      for (j = i + 1; j < netsize; j++) {\n        q = network[j];\n        if (q[1] < smallval) {\n          /* index on g */\n          smallpos = j;\n          smallval = q[1]; /* index on g */\n        }\n      }\n      q = network[smallpos];\n\n      /* swap p (i) and q (smallpos) entries */\n      if (i != smallpos) {\n        j = q[0];\n        q[0] = p[0];\n        p[0] = j;\n        j = q[1];\n        q[1] = p[1];\n        p[1] = j;\n        j = q[2];\n        q[2] = p[2];\n        p[2] = j;\n        j = q[3];\n        q[3] = p[3];\n        p[3] = j;\n      }\n\n      /* smallval entry is now in position i */\n\n      if (smallval != previouscol) {\n        netindex[previouscol] = (startpos + i) >> 1;\n\n        for (j = previouscol + 1; j < smallval; j++) netindex[j] = i;\n\n        previouscol = smallval;\n        startpos = i;\n      }\n    }\n\n    netindex[previouscol] = (startpos + maxnetpos) >> 1;\n    for (j = previouscol + 1; j < 256; j++) netindex[j] = maxnetpos; /* really 256 */\n  };\n\n  /*\n   * Main Learning Loop ------------------\n   */\n\n  let learn = function learn() {\n    let i;\n    let j;\n    let b;\n    let g;\n    let r;\n    let radius;\n    let rad;\n    let alpha;\n    let step;\n    let delta;\n    let samplepixels;\n    let p;\n    let pix;\n    let lim;\n\n    if (lengthcount < minpicturebytes) samplefac = 1;\n\n    alphadec = 30 + (samplefac - 1) / 3;\n    p = thepicture;\n    pix = 0;\n    lim = lengthcount;\n    samplepixels = lengthcount / (3 * samplefac);\n    delta = (samplepixels / ncycles) | 0;\n    alpha = initalpha;\n    radius = initradius;\n\n    rad = radius >> radiusbiasshift;\n    if (rad <= 1) rad = 0;\n\n    for (i = 0; i < rad; i++) radpower[i] = alpha * (((rad * rad - i * i) * radbias) / (rad * rad));\n\n    if (lengthcount < minpicturebytes) step = 3;\n    else if (lengthcount % prime1 !== 0) step = 3 * prime1;\n    else {\n      if (lengthcount % prime2 !== 0) step = 3 * prime2;\n      else if ((lengthcount % prime3) !== 0) step = 3 * prime3;\n      else step = 3 * prime4;\n    }\n\n    i = 0;\n    while (i < samplepixels) {\n      b = (p[pix + 0] & 0xff) << netbiasshift;\n      g = (p[pix + 1] & 0xff) << netbiasshift;\n      r = (p[pix + 2] & 0xff) << netbiasshift;\n      j = contest(b, g, r);\n\n      altersingle(alpha, j, b, g, r);\n      if (rad !== 0) alterneigh(rad, j, b, g, r); /* alter neighbours */\n\n      pix += step;\n      if (pix >= lim) pix -= lengthcount;\n\n      i++;\n\n      if (delta === 0) delta = 1;\n\n      if (i % delta === 0) {\n        alpha -= alpha / alphadec;\n        radius -= radius / radiusdec;\n        rad = radius >> radiusbiasshift;\n\n        if (rad <= 1) rad = 0;\n\n        for (j = 0; j < rad; j++)\n          radpower[j] = alpha * (((rad * rad - j * j) * radbias) / (rad * rad));\n      }\n    }\n  };\n\n  /*\n   ** Search for BGR values 0..255 (after net is unbiased) and return colour\n   * index\n   * ----------------------------------------------------------------------------\n   */\n\n  let map = (exports.map = function map(b, g, r) {\n    let i;\n    let j;\n    let dist;\n    let a;\n    let bestd;\n    let p;\n    let best;\n\n    bestd = 1000; /* biggest possible dist is 256*3 */\n    best = -1;\n    i = netindex[g]; /* index on g */\n    j = i - 1; /* start at netindex[g] and work outwards */\n\n    while (i < netsize || j >= 0) {\n      if (i < netsize) {\n        p = network[i];\n        dist = p[1] - g; /* inx key */\n\n        if (dist >= bestd) i = netsize;\n        /* stop iter */ else {\n          i++;\n          if (dist < 0) dist = -dist;\n          a = p[0] - b;\n          if (a < 0) a = -a;\n          dist += a;\n\n          if (dist < bestd) {\n            a = p[2] - r;\n            if (a < 0) a = -a;\n            dist += a;\n\n            if (dist < bestd) {\n              bestd = dist;\n              best = p[3];\n            }\n          }\n        }\n      }\n\n      if (j >= 0) {\n        p = network[j];\n        dist = g - p[1]; /* inx key - reverse dif */\n\n        if (dist >= bestd) j = -1;\n        /* stop iter */ else {\n          j--;\n          if (dist < 0) dist = -dist;\n          a = p[0] - b;\n          if (a < 0) a = -a;\n          dist += a;\n\n          if (dist < bestd) {\n            a = p[2] - r;\n            if (a < 0) a = -a;\n            dist += a;\n            if (dist < bestd) {\n              bestd = dist;\n              best = p[3];\n            }\n          }\n        }\n      }\n    }\n\n    return best;\n  });\n\n  let process = (exports.process = function process() {\n    learn();\n    unbiasnet();\n    inxbuild();\n    return colorMap();\n  });\n\n  /*\n   * Unbias network to give byte values 0..255 and record position i to prepare\n   * for sort\n   * -----------------------------------------------------------------------------------\n   */\n\n  var unbiasnet = function unbiasnet() {\n    let i;\n    let j;\n\n    for (i = 0; i < netsize; i++) {\n      network[i][0] >>= netbiasshift;\n      network[i][1] >>= netbiasshift;\n      network[i][2] >>= netbiasshift;\n      network[i][3] = i; /* record colour no */\n    }\n  };\n\n  /*\n   * Move adjacent neurons by precomputed alpha*(1-((i-j)^2/[r]^2)) in\n   * radpower[|i-j|]\n   * ---------------------------------------------------------------------------------\n   */\n\n  var alterneigh = function alterneigh(rad, i, b, g, r) {\n    let j;\n    let k;\n    let lo;\n    let hi;\n    let a;\n    let m;\n    let p;\n\n    lo = i - rad;\n    if (lo < -1) lo = -1;\n\n    hi = i + rad;\n    if (hi > netsize) hi = netsize;\n\n    j = i + 1;\n    k = i - 1;\n    m = 1;\n\n    while (j < hi || k > lo) {\n      a = radpower[m++];\n\n      if (j < hi) {\n        p = network[j++];\n\n        try {\n          p[0] -= (a * (p[0] - b)) / alpharadbias;\n          p[1] -= (a * (p[1] - g)) / alpharadbias;\n          p[2] -= (a * (p[2] - r)) / alpharadbias;\n        } catch (e) { } // prevents 1.3 miscompilation\n      }\n\n      if (k > lo) {\n        p = network[k--];\n\n        try {\n          p[0] -= (a * (p[0] - b)) / alpharadbias;\n          p[1] -= (a * (p[1] - g)) / alpharadbias;\n          p[2] -= (a * (p[2] - r)) / alpharadbias;\n        } catch (e) { }\n      }\n    }\n  };\n\n  /*\n   * Move neuron i towards biased (b,g,r) by factor alpha\n   * ----------------------------------------------------\n   */\n\n  var altersingle = function altersingle(alpha, i, b, g, r) {\n    /* alter hit neuron */\n    let n = network[i];\n    n[0] -= (alpha * (n[0] - b)) / initalpha;\n    n[1] -= (alpha * (n[1] - g)) / initalpha;\n    n[2] -= (alpha * (n[2] - r)) / initalpha;\n  };\n\n  /*\n   * Search for biased BGR values ----------------------------\n   */\n\n  var contest = function contest(b, g, r) {\n    /* finds closest neuron (min dist) and updates freq */\n    /* finds best neuron (min dist-bias) and returns position */\n    /* for frequently chosen neurons, freq[i] is high and bias[i] is negative */\n    /* bias[i] = gamma*((1/netsize)-freq[i]) */\n\n    let i;\n    let dist;\n    let a;\n    let biasdist;\n    let betafreq;\n    let bestpos;\n    let bestbiaspos;\n    let bestd;\n    let bestbiasd;\n    let n;\n\n    bestd = ~(1 << 31);\n    bestbiasd = bestd;\n    bestpos = -1;\n    bestbiaspos = bestpos;\n\n    for (i = 0; i < netsize; i++) {\n      n = network[i];\n      dist = n[0] - b;\n      if (dist < 0) dist = -dist;\n      a = n[1] - g;\n      if (a < 0) a = -a;\n      dist += a;\n      a = n[2] - r;\n      if (a < 0) a = -a;\n      dist += a;\n\n      if (dist < bestd) {\n        bestd = dist;\n        bestpos = i;\n      }\n\n      biasdist = dist - (bias[i] >> (intbiasshift - netbiasshift));\n\n      if (biasdist < bestbiasd) {\n        bestbiasd = biasdist;\n        bestbiaspos = i;\n      }\n\n      betafreq = freq[i] >> betashift;\n      freq[i] -= betafreq;\n      bias[i] += betafreq << gammashift;\n    }\n\n    freq[bestpos] += beta;\n    bias[bestpos] -= betagamma;\n    return bestbiaspos;\n  };\n\n  NeuQuant.apply(this, arguments);\n  return exports;\n};\n\nexport { NeuQuant };\n","/* eslint-disable import/prefer-default-export */\n/* eslint-disable no-continue */\n/* eslint-disable no-unused-vars */\n/* eslint-disable prefer-rest-params */\n/* eslint-disable func-names */\n/* eslint-disable camelcase */\n/* eslint-disable no-bitwise */\n/* eslint-disable no-shadow */\n/* eslint-disable eqeqeq */\n/* eslint-disable no-labels */\n/* eslint-disable no-cond-assign */\n/* eslint-disable no-restricted-syntax */\n/* eslint-disable no-use-before-define */\n/* eslint-disable no-multi-assign */\n/* eslint-disable no-plusplus */\n/* eslint-disable no-var */\n/* eslint-disable prefer-const */\n/**\n * This class handles LZW encoding\n * Adapted from Jef Poskanzer's Java port by way of J. M. G. Elliott.\n * @author Kevin Weiner (original Java version - kweiner@fmsware.com)\n * @author Thibault Imbert (AS3 version - bytearray.org)\n * @author Kevin Kwok (JavaScript version - https://github.com/antimatter15/jsgif)\n * @version 0.1 AS3 implementation\n */\n\nconst LZWEncoder = function() {\n  let exports = {};\n  let EOF = -1;\n  let imgW;\n  let imgH;\n  let pixAry;\n  let initCodeSize;\n  let remaining;\n  let curPixel;\n\n  // GIFCOMPR.C - GIF Image compression routines\n  // Lempel-Ziv compression based on 'compress'. GIF modifications by\n  // David Rowley (mgardi@watdcsu.waterloo.edu)\n  // General DEFINEs\n\n  let BITS = 12;\n  let HSIZE = 5003; // 80% occupancy\n\n  // GIF Image compression - modified 'compress'\n  // Based on: compress.c - File compression ala IEEE Computer, June 1984.\n  // By Authors: Spencer W. Thomas (decvax!harpo!utah-cs!utah-gr!thomas)\n  // Jim McKie (decvax!mcvax!jim)\n  // Steve Davies (decvax!vax135!petsd!peora!srd)\n  // Ken Turkowski (decvax!decwrl!turtlevax!ken)\n  // James A. Woods (decvax!ihnp4!ames!jaw)\n  // Joe Orost (decvax!vax135!petsd!joe)\n\n  let n_bits; // number of bits/code\n  let maxbits = BITS; // user settable max # bits/code\n  let maxcode; // maximum code, given n_bits\n  let maxmaxcode = 1 << BITS; // should NEVER generate this code\n  let htab = [];\n  let codetab = [];\n  let hsize = HSIZE; // for dynamic table sizing\n  let free_ent = 0; // first unused entry\n\n  // block compression parameters -- after all codes are used up,\n  // and compression rate changes, start over.\n\n  let clear_flg = false;\n\n  // Algorithm: use open addressing double hashing (no chaining) on the\n  // prefix code / next character combination. We do a variant of Knuth's\n  // algorithm D (vol. 3, sec. 6.4) along with G. Knott's relatively-prime\n  // secondary probe. Here, the modular division first probe is gives way\n  // to a faster exclusive-or manipulation. Also do block compression with\n  // an adaptive reset, whereby the code table is cleared when the compression\n  // ratio decreases, but after the table fills. The variable-length output\n  // codes are re-sized at this point, and a special CLEAR code is generated\n  // for the decompressor. Late addition: construct the table according to\n  // file size for noticeable speed improvement on small files. Please direct\n  // questions about this implementation to ames!jaw.\n\n  let g_init_bits;\n  let ClearCode;\n  let EOFCode;\n\n  // output\n  // Output the given code.\n  // Inputs:\n  // code: A n_bits-bit integer. If == -1, then EOF. This assumes\n  // that n_bits =< wordsize - 1.\n  // Outputs:\n  // Outputs code to the file.\n  // Assumptions:\n  // Chars are 8 bits long.\n  // Algorithm:\n  // Maintain a BITS character long buffer (so that 8 codes will\n  // fit in it exactly). Use the VAX insv instruction to insert each\n  // code in turn. When the buffer fills up empty it and start over.\n\n  let cur_accum = 0;\n  let cur_bits = 0;\n  let masks = [\n    0x0000,\n    0x0001,\n    0x0003,\n    0x0007,\n    0x000f,\n    0x001f,\n    0x003f,\n    0x007f,\n    0x00ff,\n    0x01ff,\n    0x03ff,\n    0x07ff,\n    0x0fff,\n    0x1fff,\n    0x3fff,\n    0x7fff,\n    0xffff\n  ];\n\n  // Number of characters so far in this 'packet'\n  let a_count;\n\n  // Define the storage for the packet accumulator\n  let accum = [];\n\n  let LZWEncoder = (exports.LZWEncoder = function LZWEncoder(width, height, pixels, color_depth) {\n    imgW = width;\n    imgH = height;\n    pixAry = pixels;\n    initCodeSize = Math.max(2, color_depth);\n  });\n\n  // Add a character to the end of the current packet, and if it is 254\n  // characters, flush the packet to disk.\n  let char_out = function char_out(c, outs) {\n    accum[a_count++] = c;\n    if (a_count >= 254) flush_char(outs);\n  };\n\n  // Clear out the hash table\n  // table clear for block compress\n\n  let cl_block = function cl_block(outs) {\n    cl_hash(hsize);\n    free_ent = ClearCode + 2;\n    clear_flg = true;\n    output(ClearCode, outs);\n  };\n\n  // reset code table\n  var cl_hash = function cl_hash(hsize) {\n    for (let i = 0; i < hsize; ++i) htab[i] = -1;\n  };\n\n  let compress = (exports.compress = function compress(init_bits, outs) {\n    let fcode;\n    let i; /* = 0 */\n    let c;\n    let ent;\n    let disp;\n    let hsize_reg;\n    let hshift;\n\n    // Set up the globals: g_init_bits - initial number of bits\n    g_init_bits = init_bits;\n\n    // Set up the necessary values\n    clear_flg = false;\n    n_bits = g_init_bits;\n    maxcode = MAXCODE(n_bits);\n\n    ClearCode = 1 << (init_bits - 1);\n    EOFCode = ClearCode + 1;\n    free_ent = ClearCode + 2;\n\n    a_count = 0; // clear packet\n\n    ent = nextPixel();\n\n    hshift = 0;\n    for (fcode = hsize; fcode < 65536; fcode *= 2) ++hshift;\n    hshift = 8 - hshift; // set hash code range bound\n\n    hsize_reg = hsize;\n    cl_hash(hsize_reg); // clear hash table\n\n    output(ClearCode, outs);\n\n    outer_loop: while ((c = nextPixel()) != EOF) {\n      fcode = (c << maxbits) + ent;\n      i = (c << hshift) ^ ent; // xor hashing\n\n      if (htab[i] == fcode) {\n        ent = codetab[i];\n        continue;\n      } else if (htab[i] >= 0) {\n        // non-empty slot\n\n        disp = hsize_reg - i; // secondary hash (after G. Knott)\n        if (i === 0) disp = 1;\n\n        do {\n          if ((i -= disp) < 0) i += hsize_reg;\n\n          if (htab[i] == fcode) {\n            ent = codetab[i];\n            continue outer_loop;\n          }\n        } while (htab[i] >= 0);\n      }\n\n      output(ent, outs);\n      ent = c;\n      if (free_ent < maxmaxcode) {\n        codetab[i] = free_ent++; // code -> hashtable\n        htab[i] = fcode;\n      } else cl_block(outs);\n    }\n\n    // Put out the final code.\n    output(ent, outs);\n    output(EOFCode, outs);\n  });\n\n  // ----------------------------------------------------------------------------\n  let encode = (exports.encode = function encode(os) {\n    os.writeByte(initCodeSize); // write \"initial code size\" byte\n    remaining = imgW * imgH; // reset navigation variables\n    curPixel = 0;\n    compress(initCodeSize + 1, os); // compress and write the pixel data\n    os.writeByte(0); // write block terminator\n  });\n\n  // Flush the packet to disk, and reset the accumulator\n  var flush_char = function flush_char(outs) {\n    if (a_count > 0) {\n      outs.writeByte(a_count);\n      outs.writeBytes(accum, 0, a_count);\n      a_count = 0;\n    }\n  };\n\n  var MAXCODE = function MAXCODE(n_bits) {\n    return (1 << n_bits) - 1;\n  };\n\n  // ----------------------------------------------------------------------------\n  // Return the next pixel from the image\n  // ----------------------------------------------------------------------------\n\n  var nextPixel = function nextPixel() {\n    if (remaining === 0) return EOF;\n    --remaining;\n    let pix = pixAry[curPixel++];\n    return pix & 0xff;\n  };\n\n  var output = function output(code, outs) {\n    cur_accum &= masks[cur_bits];\n\n    if (cur_bits > 0) cur_accum |= code << cur_bits;\n    else cur_accum = code;\n\n    cur_bits += n_bits;\n\n    while (cur_bits >= 8) {\n      char_out(cur_accum & 0xff, outs);\n      cur_accum >>= 8;\n      cur_bits -= 8;\n    }\n\n    // If the next entry is going to be too big for the code size,\n    // then increase it, if possible.\n\n    if (free_ent > maxcode || clear_flg) {\n      if (clear_flg) {\n        maxcode = MAXCODE((n_bits = g_init_bits));\n        clear_flg = false;\n      } else {\n        ++n_bits;\n        if (n_bits == maxbits) maxcode = maxmaxcode;\n        else maxcode = MAXCODE(n_bits);\n      }\n    }\n\n    if (code == EOFCode) {\n      // At EOF, write the rest of the buffer.\n      while (cur_bits > 0) {\n        char_out(cur_accum & 0xff, outs);\n        cur_accum >>= 8;\n        cur_bits -= 8;\n      }\n\n      flush_char(outs);\n    }\n  };\n\n  LZWEncoder.apply(this, arguments);\n  return exports;\n};\n\nexport { LZWEncoder };\n","/* eslint-disable consistent-return */\n/* eslint-disable no-console */\n/* eslint-disable func-names */\n/* eslint-disable import/prefer-default-export */\n/* eslint-disable no-useless-concat */\n/* eslint-disable no-bitwise */\n/* eslint-disable no-return-assign */\n/* eslint-disable no-nested-ternary */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-empty */\n/* eslint-disable eqeqeq */\n/* eslint-disable no-use-before-define */\n/* eslint-disable camelcase */\n/* eslint-disable no-multi-assign */\n/* eslint-disable no-unused-vars */\n/* eslint-disable block-scoped-var */\n/* eslint-disable no-shadow */\n/* eslint-disable no-plusplus */\n/* eslint-disable no-var */\n/* eslint-disable vars-on-top */\n/**\n * This class lets you encode animated GIF files\n * Base class :  http://www.java2s.com/Code/Java/2D-Graphics-GUI/AnimatedGifEncoder.htm\n * @author Kevin Weiner (original Java version - kweiner@fmsware.com)\n * @author Thibault Imbert (AS3 version - bytearray.org)\n * @author Kevin Kwok (JavaScript version - https://github.com/antimatter15/jsgif)\n * @version 0.1 AS3 implementation\n */\nimport $ from 'jquery';\nimport { NeuQuant } from './NeuQuant';\nimport { LZWEncoder } from './LZWEncoder';\n\nconst GIFEncoder = function() {\n  for (var i = 0, chr = {}; i < 256; i++) chr[i] = String.fromCharCode(i);\n\n  function ByteArray() {\n    this.bin = [];\n  }\n\n  ByteArray.prototype.getData = function() {\n    for (var v = '', l = this.bin.length, i = 0; i < l; i++) v += chr[this.bin[i]];\n    return v;\n  };\n\n  ByteArray.prototype.writeByte = function(val) {\n    this.bin.push(val);\n  };\n\n  ByteArray.prototype.writeUTFBytes = function(string) {\n    for (let l = string.length, i = 0; i < l; i++) this.writeByte(string.charCodeAt(i));\n  };\n\n  ByteArray.prototype.writeBytes = function(array, offset, length) {\n    for (let l = length || array.length, i = offset || 0; i < l; i++) this.writeByte(array[i]);\n  };\n\n  const exports = {};\n  let width; // image size\n  let height;\n  let transparent = null; // transparent color if given\n  let transIndex; // transparent index in color table\n  let repeat = -1; // no repeat\n  let delay = 0; // frame delay (hundredths)\n  let started = false; // ready to output frames\n  let out;\n  let image; // current frame\n  let pixels; // BGR byte array from frame\n  let indexedPixels; // converted frame indexed to palette\n  let colorDepth; // number of bit planes\n  let colorTab; // RGB palette\n  const usedEntry = []; // active palette entries\n  let palSize = 7; // color table size (bits-1)\n  let dispose = -1; // disposal code (-1 = use default)\n  let closeStream = false; // close stream when finished\n  let firstFrame = true;\n  let sizeSet = false; // if false, get size from first frame\n  let sample = 10; // default sample interval for quantizer\n  let comment = 'Generated by jsgif (https://github.com/antimatter15/jsgif/)'; // default comment for generated gif\n\n  /**\n   * Sets the delay time between each frame, or changes it for subsequent frames\n   * (applies to last frame added)\n   * int delay time in milliseconds\n   * @param ms\n   */\n\n  const setDelay = (exports.setDelay = function setDelay(ms) {\n    delay = Math.round(ms / 10);\n  });\n\n  /**\n   * Sets the GIF frame disposal code for the last added frame and any\n   *\n   * subsequent frames. Default is 0 if no transparent color has been set,\n   * otherwise 2.\n   * @param code\n   * int disposal code.\n   */\n\n  const setDispose = (exports.setDispose = function setDispose(code) {\n    if (code >= 0) dispose = code;\n  });\n\n  /**\n   * Sets the number of times the set of GIF frames should be played. Default is\n   * 1; 0 means play indefinitely. Must be invoked before the first image is\n   * added.\n   *\n   * @param iter\n   * int number of iterations.\n   * @return\n   */\n\n  const setRepeat = (exports.setRepeat = function setRepeat(iter) {\n    if (iter >= 0) repeat = iter;\n  });\n\n  /**\n   * Sets the transparent color for the last added frame and any subsequent\n   * frames. Since all colors are subject to modification in the quantization\n   * process, the color in the final palette for each frame closest to the given\n   * color becomes the transparent color for that frame. May be set to null to\n   * indicate no transparent color.\n   * @param\n   * Color to be treated as transparent on display.\n   */\n\n  const setTransparent = (exports.setTransparent = function setTransparent(c) {\n    transparent = c;\n  });\n\n  /**\n   * Sets the comment for the block comment\n   * @param\n   * string to be insterted as comment\n   */\n\n  const setComment = (exports.setComment = function setComment(c) {\n    comment = c;\n  });\n\n  /**\n   * The addFrame method takes an incoming BitmapData object to create each frames\n   * @param\n   * BitmapData object to be treated as a GIF's frame\n   */\n\n  const addFrame = (exports.addFrame = function addFrame(im, is_imageData) {\n    if (im === null || !started || out === null) {\n      throw new Error('Please call start method before calling addFrame');\n    }\n\n    let ok = true;\n\n    try {\n      if (!is_imageData) {\n        image = im.getImageData(0, 0, im.canvas.width, im.canvas.height).data;\n        if (!sizeSet) setSize(im.canvas.width, im.canvas.height);\n      } else if (im instanceof ImageData) {\n        image = im.data;\n        if (width != im.width || height != im.height) {\n          setSize(im.width, im.height);\n        } else {\n        }\n      } else if (im instanceof Uint8ClampedArray) {\n        if (im.length == width * height * 4) {\n          image = im;\n        } else {\n          console.log('Please set the correct size: ImageData length mismatch');\n          ok = false;\n        }\n      } else {\n        console.log('Please provide correct input');\n        ok = false;\n      }\n      getImagePixels(); // convert to correct format if necessary\n      analyzePixels(); // build color table & map pixels\n\n      if (firstFrame) {\n        writeLSD(); // logical screen descriptior\n        writePalette(); // global color table\n        if (repeat >= 0) {\n          // use NS app extension to indicate reps\n          writeNetscapeExt();\n        }\n      }\n\n      writeGraphicCtrlExt(); // write graphic control extension\n      if (comment !== '') {\n        writeCommentExt(); // write comment extension\n      }\n      writeImageDesc(); // image descriptor\n      if (!firstFrame) writePalette(); // local color table\n      writePixels(); // encode and write pixel data\n      firstFrame = false;\n    } catch (e) {\n      ok = false;\n    }\n\n    return ok;\n  });\n\n  /**\n   * @description: Downloads the encoded gif with the given name\n   * No need of any conversion from the stream data (out) to base64\n   * Solves the issue of large file sizes when there are more frames\n   * and does not involve in creation of any temporary data in the process\n   * so no wastage of memory, and speeds up the process of downloading\n   * to just calling this function.\n   * @parameter {String} filename filename used for downloading the gif\n   */\n\n  const download = (exports.download = function download(filename) {\n    if (out === null || closeStream == false) {\n      console.log(\n        'Please call start method and add frames and call finish method before calling download'\n      );\n    } else {\n      filename =\n        filename !== undefined ? (filename.endsWith('.gif') ? filename : filename) : 'download.gif';\n      const templink = document.createElement('a');\n      templink.download = filename;\n      templink.href = URL.createObjectURL(\n        new Blob([new Uint8Array(out.bin)], { type: 'image/gif' })\n      );\n      templink.click();\n    }\n  });\n\n  const upload = (exports.upload = function upload(filename) {\n    if (out === null || closeStream == false) {\n      console.log(\n        'Please call start method and add frames and call finish method before calling download'\n      );\n    } else {\n      filename =\n        filename !== undefined ? (filename.endsWith('.gif') ? filename : filename) : 'download.gif';\n      const templink = document.createElement('a');\n      templink.target = '_blank';\n      templink.href = URL.createObjectURL(\n        new Blob([new Uint8Array(out.bin)], { type: 'image/gif' })\n      );\n      const link = $(templink)\n        .attr('href')\n        .replace('blob:', '');\n      return new Uint8Array(out.bin);\n    }\n  });\n\n  /**\n   * Adds final trailer to the GIF stream, if you don't call the finish method\n   * the GIF stream will not be valid.\n   */\n\n  const finish = (exports.finish = function finish() {\n    if (!started) return false;\n\n    let ok = true;\n    started = false;\n\n    try {\n      out.writeByte(0x3b); // gif trailer\n      closeStream = true;\n    } catch (e) {\n      ok = false;\n    }\n\n    return ok;\n  });\n\n  /**\n   * Resets some members so that a new stream can be started.\n   * This method is actually called by the start method\n   */\n\n  const reset = function reset() {\n    // reset for subsequent use\n    transIndex = 0;\n    image = null;\n    pixels = null;\n    indexedPixels = null;\n    colorTab = null;\n    closeStream = false;\n    firstFrame = true;\n  };\n\n  /**\n   * * Sets frame rate in frames per second. Equivalent to\n   * <code>setDelay(1000/fps)</code>.\n   * @param fps\n   * float frame rate (frames per second)\n   */\n\n  const setFrameRate = (exports.setFrameRate = function setFrameRate(fps) {\n    if (fps != 0xf) delay = Math.round(100 / fps);\n  });\n\n  /**\n   * Sets quality of color quantization (conversion of images to the maximum 256\n   * colors allowed by the GIF specification). Lower values (minimum = 1)\n   * produce better colors, but slow processing significantly. 10 is the\n   * default, and produces good color mapping at reasonable speeds. Values\n   * greater than 20 do not yield significant improvements in speed.\n   * @param quality\n   * int greater than 0.\n   * @return\n   */\n\n  const setQuality = (exports.setQuality = function setQuality(quality) {\n    if (quality < 1) quality = 1;\n    sample = quality;\n  });\n\n  /**\n   * Sets the GIF frame size. The default size is the size of the first frame\n   * added if this method is not invoked.\n   * @param w\n   * int frame width.\n   * @param h\n   * int frame width.\n   */\n\n  var setSize = (exports.setSize = function setSize(w, h) {\n    if (started && !firstFrame) return;\n    width = w;\n    height = h;\n    if (width < 1) width = 320;\n    if (height < 1) height = 240;\n    sizeSet = true;\n  });\n\n  /**\n   * Initiates GIF file creation on the given stream.\n   * @param os\n   * OutputStream on which GIF images are written.\n   * @return false if initial write failed.\n   */\n\n  const start = (exports.start = function start() {\n    reset();\n    let ok = true;\n    closeStream = false;\n    out = new ByteArray();\n    try {\n      out.writeUTFBytes('GIF89a'); // header\n    } catch (e) {\n      ok = false;\n    }\n\n    return (started = ok);\n  });\n\n  const cont = (exports.cont = function cont() {\n    reset();\n    const ok = true;\n    closeStream = false;\n    out = new ByteArray();\n\n    return (started = ok);\n  });\n\n  /**\n   * Analyzes image colors and creates color map.\n   */\n\n  var analyzePixels = function analyzePixels() {\n    const len = pixels.length;\n    const nPix = len / 3;\n    indexedPixels = [];\n    const nq = new NeuQuant(pixels, len, sample);\n\n    // initialize quantizer\n    colorTab = nq.process(); // create reduced palette\n\n    // map image pixels to new palette\n    let k = 0;\n    for (let j = 0; j < nPix; j++) {\n      const index = nq.map(pixels[k++] & 0xff, pixels[k++] & 0xff, pixels[k++] & 0xff);\n      usedEntry[index] = true;\n      indexedPixels[j] = index;\n    }\n\n    pixels = null;\n    colorDepth = 8;\n    palSize = 7;\n\n    // get closest match to transparent color if specified\n    if (transparent !== null) {\n      transIndex = findClosest(transparent);\n    }\n  };\n\n  /**\n   * Returns index of palette color closest to c\n   */\n\n  var findClosest = function findClosest(c) {\n    if (colorTab === null) return -1;\n    const r = (c & 0xff0000) >> 16;\n    const g = (c & 0x00ff00) >> 8;\n    const b = c & 0x0000ff;\n    let minpos = 0;\n    let dmin = 256 * 256 * 256;\n    const len = colorTab.length;\n\n    for (let i = 0; i < len; ) {\n      const dr = r - (colorTab[i++] & 0xff);\n      const dg = g - (colorTab[i++] & 0xff);\n      const db = b - (colorTab[i] & 0xff);\n      const d = dr * dr + dg * dg + db * db;\n      const index = i / 3;\n      if (usedEntry[index] && d < dmin) {\n        dmin = d;\n        minpos = index;\n      }\n      i++;\n    }\n    return minpos;\n  };\n\n  /**\n   * Extracts image pixels into byte array \"pixels\n   */\n\n  var getImagePixels = function getImagePixels() {\n    const w = width;\n    const h = height;\n    pixels = [];\n    const data = image;\n    let count = 0;\n\n    for (let i = 0; i < h; i++) {\n      for (let j = 0; j < w; j++) {\n        const b = i * w * 4 + j * 4;\n        pixels[count++] = data[b];\n        pixels[count++] = data[b + 1];\n        pixels[count++] = data[b + 2];\n      }\n    }\n  };\n\n  /**\n   * Writes Graphic Control Extension\n   */\n\n  var writeGraphicCtrlExt = function writeGraphicCtrlExt() {\n    out.writeByte(0x21); // extension introducer\n    out.writeByte(0xf9); // GCE label\n    out.writeByte(4); // data block size\n    let transp;\n    let disp;\n    if (transparent === null) {\n      transp = 0;\n      disp = 0; // dispose = no action\n    } else {\n      transp = 1;\n      disp = 2; // force clear if using transparent color\n    }\n    if (dispose >= 0) {\n      disp = dispose & 7; // user override\n    }\n    disp <<= 2;\n    // packed fields\n    out.writeByte(\n      0 | // 1:3 reserved\n      disp | // 4:6 disposal\n      0 | // 7 user input - 0 = none\n        transp\n    ); // 8 transparency flag\n\n    WriteShort(delay); // delay x 1/100 sec\n    out.writeByte(transIndex); // transparent color index\n    out.writeByte(0); // block terminator\n  };\n\n  /**\n   * Writes Comment Extention\n   */\n\n  var writeCommentExt = function writeCommentExt() {\n    out.writeByte(0x21); // extension introducer\n    out.writeByte(0xfe); // comment label\n    out.writeByte(comment.length); // Block Size (s)\n    out.writeUTFBytes(comment);\n    out.writeByte(0); // block terminator\n  };\n\n  /**\n   * Writes Image Descriptor\n   */\n\n  var writeImageDesc = function writeImageDesc() {\n    out.writeByte(0x2c); // image separator\n    WriteShort(0); // image position x,y = 0,0\n    WriteShort(0);\n    WriteShort(width); // image size\n    WriteShort(height);\n\n    // packed fields\n    if (firstFrame) {\n      // no LCT - GCT is used for first (or only) frame\n      out.writeByte(0);\n    } else {\n      // specify normal LCT\n      out.writeByte(\n        0x80 | // 1 local color table 1=yes\n        0 | // 2 interlace - 0=no\n        0 | // 3 sorted - 0=no\n        0 | // 4-5 reserved\n          palSize\n      ); // 6-8 size of color table\n    }\n  };\n\n  /**\n   * Writes Logical Screen Descriptor\n   */\n\n  var writeLSD = function writeLSD() {\n    // logical screen size\n    WriteShort(width);\n    WriteShort(height);\n    // packed fields\n    out.writeByte(\n      0x80 | // 1 : global color table flag = 1 (gct used)\n      0x70 | // 2-4 : color resolution = 7\n      0x00 | // 5 : gct sort flag = 0\n        palSize\n    ); // 6-8 : gct size\n\n    out.writeByte(0); // background color index\n    out.writeByte(0); // pixel aspect ratio - assume 1:1\n  };\n\n  /**\n   * Writes Netscape application extension to define repeat count.\n   */\n\n  var writeNetscapeExt = function writeNetscapeExt() {\n    out.writeByte(0x21); // extension introducer\n    out.writeByte(0xff); // app extension label\n    out.writeByte(11); // block size\n    out.writeUTFBytes('NETSCAPE' + '2.0'); // app id + auth code\n    out.writeByte(3); // sub-block size\n    out.writeByte(1); // loop sub-block id\n    WriteShort(repeat); // loop count (extra iterations, 0=repeat forever)\n    out.writeByte(0); // block terminator\n  };\n\n  /**\n   * Writes color table\n   */\n\n  var writePalette = function writePalette() {\n    out.writeBytes(colorTab);\n    const n = 3 * 256 - colorTab.length;\n    for (let i = 0; i < n; i++) out.writeByte(0);\n  };\n\n  var WriteShort = function WriteShort(pValue) {\n    out.writeByte(pValue & 0xff);\n    out.writeByte((pValue >> 8) & 0xff);\n  };\n\n  /**\n   * Encodes and writes pixel data\n   */\n\n  var writePixels = function writePixels() {\n    const myencoder = new LZWEncoder(width, height, indexedPixels, colorDepth);\n    myencoder.encode(out);\n  };\n\n  /**\n   * Retrieves the GIF stream\n   */\n\n  const stream = (exports.stream = function stream() {\n    return out;\n  });\n\n  const setProperties = (exports.setProperties = function setProperties(has_start, is_first) {\n    started = has_start;\n    firstFrame = is_first;\n  });\n\n  return exports;\n};\n\nexport { GIFEncoder };\n","import { user } from '../../../store/store';\n\n/* eslint-disable import/prefer-default-export */\n/* eslint-disable no-multi-assign */\n/* eslint-disable func-names */\n/* eslint-disable no-param-reassign */\n/* eslint-disable eqeqeq */\n/* eslint-disable prettier/prettier */\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n/* eslint-disable no-underscore-dangle */\n// upload.js, from https://github.com/googledrive/cors-upload-sample\n// Contributors Steve Bazyl, Mike Procopio, Jeffrey Posnick, Renaud Sauvain\n// License: Apache 2.0 http://www.apache.org/licenses/LICENSE-2.0\n//\n// Implements Resumable Upload for Google Drive as described by\n// https://developers.google.com/drive/v3/web/resumable-upload\n//\n// Modified by Paul Brewer, Economic and Financial Technology Consulting LLC\n// Nov. 1 2017\n//  1. use Google Drive API V3 instead of V2\n//  2. wrap code in a \"use strict\" IIFE, only exposing MediaUploader\n//  3. explicitly export MediaUploader as window.UploaderForGoogleDrive\n//  4. if options.token undefined, get access token from existing window.gapi instance, if any\n//\n// Nov. 7, 2017\n//  5. Change file metadata \"title\" to \"name\" in line with Drive API v2-->v3 migration advisory\n//  6. export promise wrapper as window.pUploaderForGoogleDrive\n\n// jshint browser:true, strict:true\n\nconst Uploader = window.UploaderForGoogleDrive = (function () {\n\n\n  /**\n   * Helper for implementing retries with backoff. Initial retry\n   * delay is 1 second, increasing by 2x (+jitter) for subsequent retries\n   *\n   * @constructor\n   */\n\n  const RetryHandler = function () {\n    this.interval = 1000; // Start at one second\n    this.maxInterval = 60 * 1000; // Don't wait longer than a minute\n  };\n\n  /**\n   * Invoke the function after waiting\n   *\n   * @param {function} fn Function to invoke\n   */\n  RetryHandler.prototype.retry = function (fn) {\n    setTimeout(fn, this.interval);\n    this.interval = this.nextInterval_();\n  };\n\n  /**\n   * Reset the counter (e.g. after successful request.)\n   */\n  RetryHandler.prototype.reset = function () {\n    this.interval = 1000;\n  };\n\n  /**\n   * Calculate the next wait time.\n   * @return {number} Next wait interval, in milliseconds\n   *\n   * @private\n   */\n  RetryHandler.prototype.nextInterval_ = function () {\n    const interval = this.interval * 2 + this.getRandomInt_(0, 1000);\n    return Math.min(interval, this.maxInterval);\n  };\n\n  /**\n   * Get a random int in the range of min to max. Used to add jitter to wait times.\n   *\n   * @param {number} min Lower bounds\n   * @param {number} max Upper bounds\n   * @private\n   */\n  RetryHandler.prototype.getRandomInt_ = function (min, max) {\n    return Math.floor(Math.random() * (max - min + 1) + min);\n  };\n\n  /**\n   * Helper class for resumable uploads using XHR/CORS. Can upload any Blob-like item, whether\n   * files or in-memory constructs.\n   *\n   * @example\n   * var content = new Blob([\"Hello world\"], {\"type\": \"text/plain\"});\n   * var uploader = new MediaUploader({\n   *   file: content,\n   *   token: accessToken,\n   *   onComplete: function(data) { ... }\n   *   onError: function(data) { ... }\n   * });\n   * uploader.upload();\n   *\n   * @constructor\n   * @param {object} options Hash of options\n   * @param {string} options.token Access token\n   * @param {blob} options.file Blob-like item to upload\n   * @param {string} [options.fileId] ID of file if replacing\n   * @param {object} [options.params] Additional query parameters\n   * @param {string} [options.contentType] Content-type, if overriding the type of the blob.\n   * @param {object} [options.metadata] File metadata\n   * @param {function} [options.onComplete] Callback for when upload is complete\n   * @param {function} [options.onProgress] Callback for status for the in-progress upload\n   * @param {function} [options.onError] Callback if upload fails\n   */\n  const MediaUploader = function (options) {\n    const noop = function () { };\n    this.file = options.file;\n    this.contentType = options.contentType || this.file.type || 'application/octet-stream';\n    this.metadata = options.metadata || {\n      name: this.file.name,\n      mimeType: this.contentType\n    };\n    // if options.token omitted, get access_token from existing window.gapi instance, if any : PJB 2017-11-01\n    // see https://developers.google.com/api-client-library/javascript/reference/referencedocs\n    if (options.token) {\n      this.token = options.token;\n    } else {\n      try {\n        this.token = window.gapi.auth2\n          .getAuthInstance()\n          .currentUser.get()\n          .getAuthResponse(true).access_token;\n        user.dispatch({ type: 'token', value: this.token })\n      } catch (e) {\n        console.log(e);\n        throw new Error('Uploader: missing Google OAuth2 access_token');\n      }\n    }\n    // end access_token patch -- PJB 2017-11-01\n    this.onComplete = options.onComplete || noop;\n    this.onProgress = options.onProgress || noop;\n    this.onError = options.onError || noop;\n    this.offset = options.offset || 0;\n    this.chunkSize = options.chunkSize || 0;\n    this.retryHandler = new RetryHandler();\n\n    this.url = options.url;\n    if (!this.url) {\n      const params = options.params || {};\n      params.uploadType = 'resumable';\n      this.url = this.buildUrl_(options.fileId, params, options.baseUrl);\n    }\n    // PJB 2018.01.22 Change \"update/replace\" method from \"PUT\" to \"PATCH\"\n    //   per https://developers.google.com/drive/v3/reference/files/update\n    this.httpMethod = options.fileId ? 'PATCH' : 'POST';\n  };\n\n  /**\n   * Initiate the upload.\n   */\n  MediaUploader.prototype.upload = function () {\n    const self = this;\n    const xhr = new XMLHttpRequest();\n\n    xhr.open(this.httpMethod, this.url, true);\n    xhr.setRequestHeader('Authorization', `Bearer ${this.token}`);\n    xhr.setRequestHeader('Content-Type', 'application/json');\n    xhr.setRequestHeader('X-Upload-Content-Length', this.file.size);\n    xhr.setRequestHeader('X-Upload-Content-Type', this.contentType);\n    xhr.setRequestHeader('writersCanShare', true);\n\n    xhr.onload = function (e) {\n      if (e.target.status < 400) {\n        const location = e.target.getResponseHeader('Location');\n        this.url = location;\n        this.sendFile_();\n      } else {\n        this.onUploadError_(e);\n      }\n    }.bind(this);\n    xhr.onerror = this.onUploadError_.bind(this);\n    xhr.send(JSON.stringify(this.metadata));\n  };\n\n  /**\n   * Send the actual file content.\n   *\n   * @private\n   */\n  MediaUploader.prototype.sendFile_ = function () {\n    let content = this.file;\n    let end = this.file.size;\n\n    if (this.offset || this.chunkSize) {\n      // Only bother to slice the file if we're either resuming or uploading in chunks\n      if (this.chunkSize) {\n        end = Math.min(this.offset + this.chunkSize, this.file.size);\n      }\n      content = content.slice(this.offset, end);\n    }\n\n    const xhr = new XMLHttpRequest();\n    xhr.open('PUT', this.url, true);\n    xhr.setRequestHeader('Content-Type', this.contentType);\n    xhr.setRequestHeader(\n      'Content-Range',\n      `bytes ${this.offset}-${end - 1}/${this.file.size}`\n    );\n    xhr.setRequestHeader('X-Upload-Content-Type', this.file.type);\n    xhr.setRequestHeader('writersCanShare', true);\n    if (xhr.upload) {\n      xhr.upload.addEventListener('progress', this.onProgress);\n    }\n    xhr.onload = this.onContentUploadSuccess_.bind(this);\n    xhr.onerror = this.onContentUploadError_.bind(this);\n    xhr.send(content);\n  };\n\n  /**\n   * Query for the state of the file for resumption.\n   *\n   * @private\n   */\n  MediaUploader.prototype.resume_ = function () {\n    const xhr = new XMLHttpRequest();\n    xhr.open('PUT', this.url, true);\n    xhr.setRequestHeader('Content-Range', `bytes */${this.file.size}`);\n    xhr.setRequestHeader('X-Upload-Content-Type', this.file.type);\n    xhr.setRequestHeader('writersCanShare', true);\n    if (xhr.upload) {\n      xhr.upload.addEventListener('progress', this.onProgress);\n    }\n    xhr.onload = this.onContentUploadSuccess_.bind(this);\n    xhr.onerror = this.onContentUploadError_.bind(this);\n    xhr.send();\n  };\n\n  /**\n   * Extract the last saved range if available in the request.\n   *\n   * @param {XMLHttpRequest} xhr Request object\n   */\n  MediaUploader.prototype.extractRange_ = function (xhr) {\n    const range = xhr.getResponseHeader('Range');\n    if (range) {\n      this.offset = parseInt(range.match(/\\d+/g).pop(), 10) + 1;\n    }\n  };\n\n  /**\n   * Handle successful responses for uploads. Depending on the context,\n   * may continue with uploading the next chunk of the file or, if complete,\n   * invokes the caller's callback.\n   *\n   * @private\n   * @param {object} e XHR event\n   */\n  MediaUploader.prototype.onContentUploadSuccess_ = function (e) {\n    if (e.target.status == 200 || e.target.status == 201) {\n      this.onComplete(e.target.response);\n    } else if (e.target.status == 308) {\n      this.extractRange_(e.target);\n      this.retryHandler.reset();\n      this.sendFile_();\n    } else {\n      this.onContentUploadError_(e);\n    }\n  };\n\n  /**\n   * Handles errors for uploads. Either retries or aborts depending\n   * on the error.\n   *\n   * @private\n   * @param {object} e XHR event\n   */\n  MediaUploader.prototype.onContentUploadError_ = function (e) {\n    if (e.target.status && e.target.status < 500) {\n      this.onError(e.target.response);\n    } else {\n      this.retryHandler.retry(this.resume_.bind(this));\n    }\n  };\n\n  /**\n   * Handles errors for the initial request.\n   *\n   * @private\n   * @param {object} e XHR event\n   */\n  MediaUploader.prototype.onUploadError_ = function (e) {\n    this.onError(e.target.response); // TODO - Retries for initial upload\n  };\n\n  /**\n   * Construct a query string from a hash/object\n   *\n   * @private\n   * @param {object} [params] Key/value pairs for query string\n   * @return {string} query string\n   */\n  MediaUploader.prototype.buildQuery_ = function (params) {\n    params = params || {};\n    return Object.keys(params)\n      .map(function (key) {\n        return `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`;\n      })\n      .join('&');\n  };\n\n  /**\n   * Build the drive upload URL\n   *\n   * @private\n   * @param {string} [id] File ID if replacing\n   * @param {object} [params] Query parameters\n   * @return {string} URL\n   */\n  MediaUploader.prototype.buildUrl_ = function (id, params, baseUrl) {\n    // modified next line to use v3, not v2 -- PJB, 2017-11-01\n    let url = baseUrl || 'https://www.googleapis.com/upload/drive/v3/files/';\n    if (id) {\n      url += id;\n    }\n    const query = this.buildQuery_(params);\n    if (query) {\n      url += `?${query}`;\n    }\n    return url;\n  };\n\n  return MediaUploader;\n})();\n\nwindow.pUploaderForGoogleDrive = function (options) {\n\n\n  return new Promise(function (resolve, reject) {\n    options.onComplete = function (r) {\n      let response;\n      try {\n        response = typeof r === 'string' ? JSON.parse(r) : r;\n      } catch (e) {\n        response = r;\n      }\n      resolve(response);\n    };\n    options.onError = function (e) {\n      reject(e);\n    };\n    const uploader = new window.UploaderForGoogleDrive(options);\n    uploader.upload();\n  });\n};\n\nexport { Uploader };\n","/* eslint-disable no-console */\nimport $ from 'jquery';\nimport { GIFEncoder } from '../../gifModule/jsgif-master/GIFEncoder';\nimport encode64 from '../../gifModule/jsgif-master/b64';\nimport { store, canvas, settings, user } from '../../../store/store';\nimport { Uploader } from './googleUploader';\n\nlet delay;\nstore.subscribe(() => {\n  const fps = store.getState().fps || 3;\n  delay = 1000 / fps;\n});\nlet currentCanvas;\ncanvas.subscribe(() => {\n  currentCanvas = canvas.getState().currentCanvas;\n});\nlet filename;\nsettings.subscribe(() => {\n  filename = settings.getState().title;\n});\n\nfunction debugBase64(base64URL) {\n  const win = window.open();\n  $(win.document.body).css({\n    display: 'flex',\n    width: '100vw',\n    heigh: '100vh',\n    'justify-content': 'center',\n    'align-items': 'center',\n    background: 'whitesmoke'\n  });\n  $('<img></img>', {\n    src: base64URL\n  }).appendTo(win.document.body);\n}\n\nfunction debugBase64WithText(array, base64URL) {\n  const win = window.open();\n  $(win.document.body).css({\n    display: 'flex',\n    'flex-direction': 'column',\n    width: '100vw',\n    height: '100vh',\n    'align-items': 'center',\n    background: 'whitesmoke',\n    overflow: 'hidden'\n  });\n  const ancor = $('<div></div>', {\n    id: 'ancor',\n    width: '100%',\n    height: '50%'\n  })\n    .appendTo(win.document.body)\n    .css({\n      width: '80%',\n      height: '50%',\n      background: 'white',\n      'overflow-y': 'scroll',\n      'margin-bottom': '25px',\n      border: '1px solid black'\n    });\n  for (let i = 0; i < array.length; i += 1) {\n    $('<img></img>', {\n      src: array[i],\n      width: '25%'\n    })\n      .appendTo(ancor)\n      .css({ border: '1px solid black' });\n  }\n  $('<div></div>', {\n    text: base64URL\n  })\n    .appendTo(win.document.body)\n    .css({\n      display: 'flex',\n      'flex-wrap': 'wrap',\n      width: '80%',\n      height: '40%',\n      'overflow-y': 'scroll',\n      'word-break': 'break-word'\n    });\n}\n\nfunction saveAsGif(upload) {\n  const encoder = new GIFEncoder();\n  encoder.setRepeat(0);\n  encoder.setDelay(delay);\n  encoder.start();\n\n  for (let i = 0; i < $('#canvas-block').children().length; i += 1) {\n    const curCanv = document.querySelector(`#canvas${i + 1}`);\n    const originalContext = $(`#canvas${i + 1}`)\n      .get(0)\n      .getContext('2d');\n    const imageData = originalContext.getImageData(\n      0,\n      0,\n      $(`#canvas${i + 1}`).width(),\n      $(`#canvas${i + 1}`).width()\n    );\n    let len = imageData.data.length;\n    const newArr = [];\n    let map1;\n    let map2;\n    let count = 0;\n    while (len > 0) {\n      map1 = imageData.data.slice(count, count + 4);\n      map2 = map1;\n      if (map2.every(item => item === 0)) {\n        map2 = map2.map(() => 255);\n      }\n      newArr.push(...map2);\n      count += 4;\n      len -= 4;\n    }\n    const fixedNewArray = Uint8ClampedArray.from(newArr);\n    const newImage = new ImageData(fixedNewArray, curCanv.width, curCanv.height);\n    encoder.setSize(curCanv.height, curCanv.width);\n    encoder.addFrame(newImage, true);\n  }\n  encoder.finish();\n  filename = filename || 'New Piskel-clone';\n  if (upload) {\n    return encoder.upload(`${filename}.gif`);\n  }\n  return encoder.download(`${filename}.gif`);\n}\n\nfunction uploadToUrl() {\n  const encoder = new GIFEncoder();\n  encoder.setRepeat(0);\n  encoder.setDelay(delay);\n  encoder.start();\n\n  for (let i = 0; i < $('#canvas-block').children().length; i += 1) {\n    const curCanv = document.querySelector(`#canvas${i + 1}`);\n    const originalContext = $(`#canvas${i + 1}`)\n      .get(0)\n      .getContext('2d');\n    const imageData = originalContext.getImageData(\n      0,\n      0,\n      $(`#canvas${i + 1}`).width(),\n      $(`#canvas${i + 1}`).width()\n    );\n    let len = imageData.data.length;\n    const newArr = [];\n    let map1;\n    let map2;\n    let count = 0;\n    while (len > 0) {\n      map1 = imageData.data.slice(count, count + 4);\n      map2 = map1;\n      if (map2.every(item => item === 0)) {\n        map2 = map2.map(() => 255);\n      }\n      newArr.push(...map2);\n      count += 4;\n      len -= 4;\n    }\n    const fixedNewArray = Uint8ClampedArray.from(newArr);\n    const newImage = new ImageData(fixedNewArray, curCanv.width, curCanv.height);\n    encoder.setSize(curCanv.height, curCanv.width);\n    encoder.addFrame(newImage, true);\n  }\n  encoder.finish();\n  const binaryGif = encoder.stream().getData();\n  const dataUrl = `data:image/gif;base64,${encode64(binaryGif)}`;\n  return dataUrl;\n}\n\nfunction downloadPng() {\n  const i = currentCanvas;\n  const encoder = new GIFEncoder();\n  encoder.setRepeat(0);\n  encoder.setDelay(delay);\n  encoder.start();\n  const width = $(`#canvas${i}`).width();\n  const originalContext = $(`#canvas${i}`)\n    .get(0)\n    .getContext('2d');\n  const imageData = originalContext.getImageData(0, 0, width, width);\n  let len = imageData.data.length;\n  const newArr = [];\n  let map1;\n  let map2;\n  let count = 0;\n  while (len > 0) {\n    map1 = imageData.data.slice(count, count + 4);\n    map2 = map1;\n    if (map2.every(item => item === 0)) {\n      map2 = map2.map(() => 255);\n    }\n    newArr.push(...map2);\n    count += 4;\n    len -= 4;\n  }\n  const fixedNewArray = Uint8ClampedArray.from(newArr);\n  const newImage = new ImageData(fixedNewArray, width, width);\n  encoder.setSize(width, width);\n  encoder.addFrame(newImage, true);\n  encoder.finish();\n  filename = filename || 'New Piskel-clone';\n  encoder.download(`${filename}.png`);\n}\n\nconst apikey = 'AIzaSyD8p3NmO-jrbUeGpC9EYDHzH8FWOl3ivss';\nfunction loadClient() {\n  window.gapi.client.setApiKey(apikey);\n  return window.gapi.client\n    .load('https://content.googleapis.com/discovery/v1/apis/drive/v3/rest')\n    .then(\n      () => {\n        console.log('GAPI client loaded for API');\n      },\n      err => {\n        console.error('Error loading GAPI client for API', err);\n      }\n    );\n}\n\nfunction uploadToGoogle() {\n  loadClient();\n  const content = new Blob([saveAsGif('upload')], { type: 'image/gif' });\n  const uploader = new Uploader({\n    file: content,\n    metadata: {\n      name: filename\n    },\n    onComplete(data) {\n      const info = JSON.parse(data);\n      const fileId = info.id;\n      const url = `https://drive.google.com/open?id=${fileId}`;\n      const urlToGif = `https://drive.google.com/thumbnail?id=${fileId}`;\n      user.dispatch({ type: 'googleUrl', value: url });\n      user.dispatch({ type: 'gifUrl', value: urlToGif });\n      $('#google-link').attr('href', url);\n      $('#span-link').attr('href', urlToGif);\n      window.gapi.client.drive.permissions\n        .create({\n          fileId: `${fileId}`,\n          resource: {\n            role: 'reader',\n            type: 'anyone'\n          }\n        })\n        .then(\n          response => {\n            // Handle the results here (response.result has the parsed body).\n            console.log('Response', response);\n          },\n          err => {\n            console.error('Execute error', err);\n          }\n        );\n    },\n    onError(data) {\n      console.log(data);\n    }\n  });\n  uploader.upload();\n}\n\nexport { saveAsGif, uploadToUrl, downloadPng, debugBase64, debugBase64WithText, uploadToGoogle };\n","/* eslint-disable no-multi-assign */\n/* eslint-disable no-restricted-globals */\n/* eslint-disable no-bitwise */\n/* eslint-disable no-plusplus */\nexport default function encode64(input) {\n  let output = '';\n  let i = 0;\n  const l = input.length;\n  const key = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n  let chr1;\n  let chr2;\n  let chr3;\n  let enc1;\n  let enc2;\n  let enc3;\n  let enc4;\n  while (i < l) {\n    chr1 = input.charCodeAt(i++);\n    chr2 = input.charCodeAt(i++);\n    chr3 = input.charCodeAt(i++);\n    enc1 = chr1 >> 2;\n    enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n    enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n    enc4 = chr3 & 63;\n    if (isNaN(chr2)) enc3 = enc4 = 64;\n    else if (isNaN(chr3)) enc4 = 64;\n    output = output + key.charAt(enc1) + key.charAt(enc2) + key.charAt(enc3) + key.charAt(enc4);\n  }\n  return output;\n}\n","/* eslint-disable no-restricted-syntax */\n/* eslint-disable guard-for-in */\nimport React from 'react';\nimport $ from 'jquery';\nimport './save.css';\nimport { options, settings, preview, user } from '../../../store/store';\nimport { uploadToUrl } from '../export/fromCanvasToFile';\nimport { getDate, saveLocally, saveToGalery } from './saveLocally';\n\nwindow.localProjects = {};\nwindow.authLocalProjects = {};\n\nlet optionsBlock;\noptions.subscribe(() => {\n  optionsBlock = options.getState().optionsBlock;\n});\nlet name;\nlet userID;\nuser.subscribe(() => {\n  name = user.getState().name;\n  userID = user.getState().userID;\n});\nlet projectID;\npreview.subscribe(() => {\n  projectID = preview.getState().piskelID;\n});\n\nclass SaveOptions extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      value: 'New Piskel',\n      isLogin: false\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    settings.dispatch({ type: 'title', value: $('#title-input').val() });\n    if (name) {\n      this.setState({ isLogin: true });\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  saveLocallyHandler() {\n    const newValue = $('#title-input').val();\n    this.setState({ value: newValue });\n    settings.dispatch({ type: 'title', value: newValue });\n    const arrayFramesSrc = [];\n    for (let i = 0; i < $('.preview').children().length; i += 1) {\n      arrayFramesSrc.push($('.preview').children()[i].src);\n    }\n    const dataUrl = uploadToUrl();\n    const storageObj =\n      localStorage.getItem('localProjects') !== 'undefined'\n        ? JSON.parse(localStorage.getItem('localProjects'))\n        : undefined;\n\n    const date = getDate();\n\n    const objToSave = JSON.stringify(\n      saveLocally(\n        window.localProjects,\n        storageObj,\n        projectID,\n        dataUrl,\n        arrayFramesSrc,\n        newValue,\n        date\n      )\n    );\n    localStorage.setItem('localProjects', objToSave);\n    preview.dispatch({ type: 'projects', value: objToSave });\n    $('#addLocalPiskel').click();\n  }\n\n  saveToGaleryHandler() {\n    const newValue = $('#title-input').val();\n    this.setState({ value: newValue });\n    settings.dispatch({ type: 'title', value: newValue });\n    const arrayFramesSrc = [];\n    for (let i = 0; i < $('.preview').children().length; i += 1) {\n      arrayFramesSrc.push($('.preview').children()[i].src);\n    }\n    const dataUrl = uploadToUrl();\n    const storageObj =\n      localStorage.getItem('authLocalProjects') !== 'undefined'\n        ? JSON.parse(localStorage.getItem('authLocalProjects'))\n        : undefined;\n\n    const date = getDate();\n\n    const objToSave = JSON.stringify(\n      saveToGalery(\n        window.authLocalProjects,\n        storageObj,\n        projectID,\n        dataUrl,\n        arrayFramesSrc,\n        newValue,\n        date,\n        userID\n      )\n    );\n    localStorage.setItem('authLocalProjects', objToSave);\n  }\n\n  updateState() {\n    if (name) {\n      this.setState({ isLogin: true });\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className={`save-settings-block ${optionsBlock === 'save-settings' ? 'flexed' : 'hidden'}`}\n      >\n        <div className=\"sprite-info-block\">\n          <span className=\"sprite-info bold\">Sprite information</span>\n          <span className=\"label-title\">Title:</span>\n          <input className=\"title-input\" id=\"title-input\" defaultValue={this.state.value} />\n          <span className=\"label-description\">Description:</span>\n          <textarea rows=\"1\" cols=\"6\" className=\"description-input\" id=\"description-input\" />\n        </div>\n        <div className=\"save-online-block\">\n          <span className=\"save-online bold\">Save online</span>\n          <button\n            id=\"save-locally\"\n            className=\"save-online-button\"\n            type=\"button\"\n            onClick={() => this.saveLocallyHandler()}\n          >\n            Save locally\n          </button>\n          <p className=\"save-online-info\">\n            Your piskel will be saved and available only from this browser\n          </p>\n          <button\n            id=\"save-online\"\n            className={`save-online-button ${this.state.isLogin ? '' : 'hidden'}`}\n            type=\"button\"\n            onClick={() => this.saveToGaleryHandler()}\n          >\n            Save to your gallery\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => {\n              $('.abcRioButton.abcRioButtonLightBlue').click();\n            }}\n            className={`save-online-button ${this.state.isLogin ? 'hidden' : ''}`}\n          >\n            Sign in to save to your gallery\n          </button>\n          <p className=\"save-online-info\">Your piskel will be stored online in your gallery</p>\n          <button\n            type=\"button\"\n            className=\"hidden\"\n            id=\"updateSaveButtonLoggedIn\"\n            onClick={() => this.updateState()}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default SaveOptions;\n","/* eslint-disable no-restricted-syntax */\n/* eslint-disable guard-for-in */\n\nfunction getDate() {\n  const data = new Date();\n  let day = data.getDate();\n  if (day < 10) {\n    day = `0${day}`;\n  }\n  let month = data.getMonth();\n  if (month < 10) {\n    month = `0${month}`;\n  }\n  let hour = data.getHours();\n  if (hour < 10) {\n    hour = `0${hour}`;\n  }\n  let minutes = data.getMinutes();\n  if (minutes < 10) {\n    minutes = `0${minutes}`;\n  }\n  return `${hour}:${minutes}  ${day}/${month}/${data.getFullYear()}`;\n}\n\nfunction saveLocally(global, storage, projectID, dataUrl, array, newValue, date) {\n  const piskel = projectID !== undefined ? projectID : localStorage.getItem('project');\n  const globalObj = global;\n  const idArr = [];\n  if (storage) {\n    if (Object.keys(storage).length > 0) {\n      for (const project in storage) {\n        globalObj[project] = {\n          gif: storage[project].gif,\n          frames: storage[project].frames,\n          title: storage[project].title,\n          time: storage[project].time\n        };\n      }\n    }\n  }\n  if (Object.keys(globalObj).length === 0) {\n    globalObj[piskel] = {\n      gif: dataUrl,\n      frames: array,\n      title: newValue,\n      time: date\n    };\n  } else {\n    for (const project in globalObj) {\n      if (project === piskel) {\n        globalObj[project].gif = dataUrl;\n        globalObj[project].frames = array;\n        globalObj[project].title = newValue;\n        globalObj[project].time = date;\n      }\n      idArr.push(project);\n    }\n    if (idArr.every(e => e !== piskel)) {\n      globalObj[piskel] = {\n        gif: dataUrl,\n        frames: array,\n        title: newValue,\n        time: date\n      };\n    }\n  }\n  return globalObj;\n}\n\nfunction saveToGalery(global, storage, projectID, dataUrl, arrayFramesSrc, newValue, date, userID) {\n  let globalObj = global;\n  const user = localStorage.getItem('userID');\n  // if storage with users and projects then put it in global object\n  if (storage) {\n    const storageEntries = Object.entries(storage);\n    globalObj = {};\n    for (let i = 0; i < storageEntries.length; i += 1) {\n      globalObj[storageEntries[i][0]] = {};\n      globalObj[storageEntries[i][0]] = storageEntries[i][1];\n    }\n  } else if (!storage) {\n    if (globalObj) {\n      if (Object.keys(globalObj).length === 0) {\n        globalObj[`${userID}`] = {};\n      }\n    }\n  }\n  // if object with user's projects updates then rewrite this user in global object\n  if (localStorage.getItem(`${user}`)) {\n    globalObj[`${userID}`] = {};\n    globalObj[`${userID}`] = JSON.parse(localStorage.getItem(`${user}`));\n  }\n  // update storage\n  localStorage.setItem('authLocalProjects', JSON.stringify(globalObj[`${userID}`]));\n\n  let storedObj; // object for user ID projects\n  const newstorage = localStorage.getItem('authLocalProjects');\n  if (newstorage) {\n    const entries = Object.entries(newstorage);\n    for (let i = 0; i < entries.length; i += 1) {\n      if (entries[i][0] === userID) {\n        storedObj = entries[i][1];\n      }\n    }\n  }\n  // check and rewrite user's projects\n  const authProjects = saveLocally(\n    globalObj[`${userID}`],\n    storedObj,\n    projectID,\n    dataUrl,\n    arrayFramesSrc,\n    newValue,\n    date\n  );\n  const objToSave = JSON.stringify(authProjects);\n  localStorage.setItem(`${userID}`, objToSave); // save local object with user's projects\n  globalObj[`${userID}`] = authProjects; // rewrite user's projects in global object with users\n  return globalObj;\n}\n\nexport { getDate, saveLocally, saveToGalery };\n","import React from 'react';\nimport $ from 'jquery';\nimport './export.css';\nimport { options, user } from '../../../store/store';\nimport {\n  saveAsGif,\n  uploadToUrl,\n  downloadPng,\n  debugBase64,\n  debugBase64WithText,\n  uploadToGoogle\n} from './fromCanvasToFile';\n\nlet optionsBlock;\noptions.subscribe(() => {\n  optionsBlock = options.getState().optionsBlock;\n});\n\nlet url;\nlet gifUrl;\nlet name;\nuser.subscribe(() => {\n  url = user.getState().googleUrl;\n  gifUrl = user.getState().urlToGif;\n  name = user.getState().name;\n  // console.log(url);\n});\nclass ExportOptions extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      active: 'show-gif-block',\n      dataUrl: '',\n      googleUrl: '',\n      isLogin: false\n    };\n  }\n\n  componentWillMount() {\n    this.mounted = true;\n    if (name) {\n      this.setState({ isLogin: true });\n    }\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  showExportOptions(e) {\n    const clicked = e.target.getAttribute('id');\n    this.setState({ active: clicked });\n  }\n\n  updateState() {\n    if (name) {\n      this.setState({ isLogin: true });\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className={`export-settings-block ${\n          optionsBlock === 'export-settings' ? 'flexed' : 'hidden'\n        }`}\n      >\n        <span className=\"export-info bold\">Export</span>\n        <div className=\"file-format-buttons\">\n          <button\n            id=\"show-gif-block\"\n            className={`show-gif-block ${\n              this.state.active === 'show-gif-block'\n                ? 'active-show-button'\n                : 'not-active-show-button'\n            }`}\n            type=\"button\"\n            onClick={e => this.showExportOptions(e)}\n          >\n            GIF\n          </button>\n          <button\n            id=\"show-png-block\"\n            className={`show-png-block ${\n              this.state.active === 'show-png-block'\n                ? 'active-show-button'\n                : 'not-active-show-button'\n            }`}\n            type=\"button\"\n            onClick={e => this.showExportOptions(e)}\n          >\n            PNG\n          </button>\n        </div>\n        <div\n          className={`gif-block ${this.state.active === 'show-gif-block' ? 'flexed' : 'hidden'}`}\n        >\n          <span className=\"gif-title\">Convert your sprite to an animated GIF</span>\n          <div className=\"download-block\">\n            <button\n              id=\"download-gif\"\n              className=\"gif-button\"\n              type=\"button\"\n              onClick={() => saveAsGif()}\n            >\n              Download\n            </button>\n            <span className=\"download-gif-title\">Download as an animated GIF</span>\n          </div>\n          <div className=\"download-block\">\n            <button\n              id=\"upload-gif\"\n              className=\"gif-button\"\n              type=\"button\"\n              onClick={() => {\n                const dataUrl = uploadToUrl();\n                this.setState({ dataUrl });\n              }}\n            >\n              Open in new tab\n            </button>\n            <span className=\"upload-gif-title\">Watch an animated GIF in new tab</span>\n            <div className={`link-to-gif ${this.state.dataUrl ? '' : 'hidden'}`}>\n              <button\n                type=\"button\"\n                onClick={() => {\n                  debugBase64(this.state.dataUrl);\n                  this.setState({ dataUrl: '' });\n                }}\n              >\n                your animation file\n              </button>\n            </div>\n          </div>\n          <div className=\"download-block\">\n            <button\n              id=\"upload-google\"\n              className={`gif-button ${this.state.isLogin ? '' : 'hidden'}`}\n              type=\"button\"\n              onClick={() => {\n                uploadToGoogle();\n                setTimeout(() => {\n                  this.setState({ googleUrl: true });\n                }, 700);\n                setTimeout(() => {\n                  this.setState({ googleUrl: '' });\n                }, 150000);\n              }}\n            >\n              Get link\n            </button>\n            <span className={`upload-gif-google ${this.state.isLogin ? 'blocked' : 'hidden'}`}>\n              Save your animation to Google disk to share\n            </span>\n\n            <button\n              type=\"button\"\n              onClick={() => {\n                $('.abcRioButton.abcRioButtonLightBlue').click();\n              }}\n              className={`save-online-button ${this.state.isLogin ? 'hidden' : ''}`}\n            >\n              Sign in to save to Google disk\n            </button>\n            <button\n              type=\"button\"\n              className=\"hidden\"\n              id=\"updateGoogleButtonLoggedIn\"\n              onClick={() => this.updateState()}\n            />\n\n            <div className={`link-to-gif ${this.state.googleUrl ? '' : 'hidden'}`}>\n              <span>Click the link</span>\n              <a\n                className=\"google-link\"\n                id=\"google-link\"\n                rel=\"noopener noreferrer\"\n                target=\"_blank\"\n                href={url}\n              >\n                {'Link to file on Google disk'}\n              </a>\n              <a\n                className=\"google-link\"\n                id=\"span-link\"\n                rel=\"noopener noreferrer\"\n                target=\"_blank\"\n                href={gifUrl}\n              >\n                {'Direct link to your GIF'}\n              </a>\n            </div>\n          </div>\n        </div>\n\n        <div\n          className={`png-block ${this.state.active === 'show-png-block' ? 'flexed' : 'hidden'}`}\n        >\n          <span className=\"png-title\">Export your animation as a PNG file</span>\n          <div className=\"download-block\">\n            <button\n              id=\"download-png\"\n              className=\"png-button\"\n              type=\"button\"\n              onClick={() => downloadPng()}\n            >\n              Download\n            </button>\n            <span className=\"download-png-title\">Download selected frame as PNG file</span>\n          </div>\n          <div className=\"download-block\">\n            <button\n              id=\"open-png\"\n              className=\"png-button\"\n              type=\"button\"\n              onClick={() => {\n                const array = [];\n                for (let i = 0; i < $('.preview').children().length; i += 1) {\n                  array.push($('.preview').children()[i].src);\n                }\n                const dataUrl = uploadToUrl();\n                debugBase64WithText(array, dataUrl);\n              }}\n            >\n              Open\n            </button>\n            <span className=\"open-png-title\">Open the spritesheet as a data uri</span>\n          </div>\n        </div>\n        <div id=\"hidden\" className=\"hidden\" />\n      </div>\n    );\n  }\n}\n\nexport default ExportOptions;\n","import React from 'react';\nimport $ from 'jquery';\nimport './import.css';\nimport { options } from '../../../store/store';\n\n// let customWidth;\nlet optionsBlock;\noptions.subscribe(() => {\n  optionsBlock = options.getState().optionsBlock;\n});\n\nclass ImportOptions extends React.Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  render() {\n    return (\n      <div\n        className={`general-settings-block ${\n          optionsBlock === 'import-settings' ? 'flexed' : 'hidden'\n        }`}\n      >\n        <div className=\"current-bg\">\n          <span className=\"default-bg bold\">Load from browser</span>\n          <p>Load your animation saved in this browser</p>\n          <button\n            type=\"button\"\n            onClick={() => $('#showSavesButton').click()}\n            className=\"browse-local-piskels-button\"\n          >\n            Browse local saves\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ImportOptions;\n","import React from 'react';\nimport $ from 'jquery';\nimport './menu.css';\nimport { store, options } from '../../store/store';\nimport Layers from './layers-list/layers-list';\nimport Palettes from './palettes/palettes';\nimport Settings from './settings/settings';\nimport ResizeCanvas from './resize/resizeCanvas';\nimport SaveOptions from './save/save';\nimport ExportOptions from './export/export';\nimport ImportOptions from './import/import';\n\nlet fps;\nstore.subscribe(() => {\n  fps = store.getState().fps;\n});\nclass Options extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      fps: 3,\n      hovered: '',\n      active: 'none',\n      mouseEnter: false\n    };\n    this.mounted = false;\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fpsOnChangeHandler() {\n    store.dispatch({ type: 'fps', value: $('#fps-bar').val() });\n    this.setState({ fps });\n  }\n\n  popHintOnMouseOver(e) {\n    const hovered = e.target.getAttribute('id');\n    if (this.state.hovered === hovered) {\n      this.setState({ hovered: '' });\n    } else {\n      this.setState({ hovered });\n    }\n  }\n\n  mouseIn() {\n    this.setState({ mouseEnter: true });\n  }\n\n  mouseOut() {\n    this.setState({ mouseEnter: false });\n  }\n\n  showOptionsOnClick(e) {\n    const clicked =\n      $(e.target).attr('id') ||\n      $(e.target)\n        .find('i')\n        .attr('id');\n    if (this.state.active === clicked) {\n      this.setState({ active: 'none' });\n      options.dispatch({ type: 'optionsBlock', value: 'none' });\n    } else {\n      this.setState({ active: clicked });\n      options.dispatch({ type: 'optionsBlock', value: clicked });\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"optionsBox\" id=\"optionsBox\">\n        <div className=\"fps-options\">\n          <span id=\"display-fps\" className=\"display-fps\">\n            {`${this.state.fps} FPS`}\n          </span>\n          <input\n            type=\"range\"\n            min=\"1\"\n            max=\"24\"\n            step=\"1\"\n            defaultValue={this.state.fps}\n            id=\"fps-bar\"\n            className=\"fps-bar\"\n            onChange={() => this.fpsOnChangeHandler()}\n          />\n        </div>\n        <Layers />\n        <Palettes />\n        <div className={`options-blocks-area ${this.state.active === 'none' ? '' : 'slide'}`}>\n          <Settings />\n          <ResizeCanvas />\n          <SaveOptions />\n          <ExportOptions />\n          <ImportOptions />\n        </div>\n        <div\n          className={`settings-buttons ${this.state.active === 'none' ? '' : 'slide'}`}\n          onMouseOver={e => this.popHintOnMouseOver(e)}\n          onFocus={() => undefined}\n        >\n          <button\n            type=\"button\"\n            className=\"settings-button\"\n            onFocus={() => undefined}\n            onClick={e => this.showOptionsOnClick(e)}\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i\n              id=\"settings\"\n              className={`fas fa-cog ${this.state.hovered === 'settings' ? 'fas-hovered' : ''} ${\n                this.state.active === 'settings' ? 'fas-hovered' : ''\n              }`}\n            />\n          </button>\n          <button\n            type=\"button\"\n            className=\"settings-button\"\n            onFocus={() => undefined}\n            onClick={e => this.showOptionsOnClick(e)}\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i\n              id=\"resize-settings\"\n              className={`fas fa-crop ${\n                this.state.hovered === 'resize-settings' ? 'fas-hovered' : ''\n              } ${this.state.active === 'resize-settings' ? 'fas-hovered' : ''}`}\n            />\n          </button>\n          <button\n            type=\"button\"\n            className=\"settings-button\"\n            onFocus={() => undefined}\n            onClick={e => this.showOptionsOnClick(e)}\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i\n              id=\"save-settings\"\n              className={`fas fa-save ${\n                this.state.hovered === 'save-settings' ? 'fas-hovered' : ''\n              } ${this.state.active === 'save-settings' ? 'fas-hovered' : ''}`}\n            />\n          </button>\n          <button\n            type=\"button\"\n            className=\"settings-button\"\n            onFocus={() => undefined}\n            onClick={e => this.showOptionsOnClick(e)}\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i\n              id=\"export-settings\"\n              className={`fas fa-file-download ${\n                this.state.hovered === 'export-settings' ? 'fas-hovered' : ''\n              } ${this.state.active === 'export-settings' ? 'fas-hovered' : ''}`}\n            />\n          </button>\n          <button\n            type=\"button\"\n            className=\"settings-button\"\n            onFocus={() => undefined}\n            onClick={e => this.showOptionsOnClick(e)}\n            onMouseEnter={() => this.mouseIn()}\n            onMouseLeave={() => this.mouseOut()}\n          >\n            <i\n              id=\"import-settings\"\n              className={`fas fa-file-upload ${\n                this.state.hovered === 'import-settings' ? 'fas-hovered' : ''\n              } ${this.state.active === 'import-settings' ? 'fas-hovered' : ''}`}\n            />\n          </button>\n\n          <p\n            className={`hint settings-button-cog ${\n              this.state.mouseEnter === true && this.state.hovered === 'settings' ? '' : 'hidden'\n            }`}\n          >\n            Settings\n            <i className=\"settings-button-cog-arrow fas fa-caret-right\" />\n          </p>\n          <p\n            className={`big hint resize-settings ${\n              this.state.mouseEnter === true && this.state.hovered === 'resize-settings'\n                ? ''\n                : 'hidden'\n            }`}\n          >\n            Resize the drawing area\n            <i className=\"resize-settings-arrow fas fa-caret-right\" />\n          </p>\n          <p\n            className={`hint save-settings ${\n              this.state.mouseEnter === true && this.state.hovered === 'save-settings'\n                ? ''\n                : 'hidden'\n            }`}\n          >\n            Save to your galery\n            <i className=\"save-settings-arrow fas fa-caret-right\" />\n          </p>\n          <p\n            className={`big hint export-settings ${\n              this.state.mouseEnter === true && this.state.hovered === 'export-settings'\n                ? ''\n                : 'hidden'\n            }`}\n          >\n            Export as image or animated gif\n            <i className=\"export-settings-arrow fas fa-caret-right\" />\n          </p>\n          <p\n            className={`big hint import-settings ${\n              this.state.mouseEnter === true && this.state.hovered === 'import-settings'\n                ? ''\n                : 'hidden'\n            }`}\n          >\n            Import your animation\n            <i className=\"import-settings-arrow fas fa-caret-right\" />\n          </p>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Options;\n","import React from 'react';\nimport './user.css';\nimport { user } from '../../store/store';\n\nlet name;\nlet img;\nuser.subscribe(() => {\n  name = user.getState().name;\n  img = user.getState().imageURL;\n});\n\nclass User extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      active: '',\n      height: '',\n      isEmpty: true,\n      projects: []\n    };\n    this.changedProjects = '';\n    this.localObj = {};\n    this.mounted = false;\n    this.user = '';\n  }\n\n  componentWillMount() {\n    this.user = localStorage.getItem('userID');\n  }\n\n  componentDidMount() {\n    this.setState({ height: window.innerHeight });\n    this.mounted = true;\n    if (localStorage.getItem(`${this.user}`)) {\n      const obj = JSON.parse(localStorage.getItem(`${this.user}`));\n      this.setState({ isEmpty: false, projects: Object.entries(obj) });\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  deletePiskel(item) {\n    for (let i = 0; i < this.state.projects.length; i += 1) {\n      if (this.state.projects[i][0] === item) {\n        this.state.projects.splice(i, 1);\n      }\n    }\n\n    this.changedProjects = this.state.projects;\n    window[`${this.user}`] = {};\n    for (let k = 0; k < this.changedProjects.length; k += 1) {\n      window[`${this.user}`][this.changedProjects[k][0]] = this.changedProjects[k][1];\n    }\n    this.setState({ projects: this.changedProjects });\n    const projectsJson = JSON.stringify(window[`${this.user}`]);\n    localStorage.setItem(`${this.user}`, projectsJson);\n  }\n\n  hoverIn(e) {\n    if (this.mounted) {\n      this.setState({ active: e.currentTarget.id });\n    }\n  }\n\n  hoverOut() {\n    if (this.mounted) {\n      this.setState({ active: false });\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"user-page\" style={{ height: this.state.height - 110 }}>\n        <div\n          className=\"user-image\"\n          style={{\n            backgroundImage: `url(${img})`,\n            backgroundSize: 'contain'\n          }}\n        />\n        <h2 className=\"user-name\">{name}</h2>\n        <ul className=\"piskel-list\">\n          <li>all</li>\n          <li>public</li>\n          <li>private</li>\n          <li>deleted</li>\n        </ul>\n        <div id=\"user-piskel-preview-area\" className=\"user-piskel-preview-area\">\n          <span className={`${this.state.isEmpty ? '' : 'hidden'}`}>\n            No piskel available in &#39;all&#39; category.\n          </span>\n\n          <div className={`user-preview-piskel-block ${this.state.isEmpty ? 'hidden' : 'flexed'}`}>\n            {this.state.projects.map((item, i) => (\n              <div\n                key={item}\n                className=\"preview-wrapper\"\n                id={item[0]}\n                onMouseEnter={e => this.hoverIn(e)}\n                onMouseLeave={() => this.hoverOut()}\n              >\n                <img key={item[1].gif} className=\"preview-gif\" src={item[1].gif} alt=\"preview\" />\n                <span key={item[1].title} className=\"preview-gif-title\">\n                  {item[1].title}\n                </span>\n                <span key={item[1].time} className=\"preview-gif-date\">\n                  {item[1].time}\n                </span>\n                <button\n                  type=\"button\"\n                  className={`piskel-preview-button ${\n                    this.state.active === item[0] ? '' : 'hidden'\n                  }`}\n                  onClick={() => this.deletePiskel(item[0])}\n                >\n                  <i className=\"fas fa-trash-alt\" />\n                </button>\n                <div key={item[1].frames} className=\"hidden\">\n                  {item[1].frames.map(frame => (\n                    <img key={frame} src={frame} alt=\"img\" />\n                  ))}\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n        <div className=\"hidden\">\n          <button id=\"userAddPiskel\" type=\"button\" onClick={undefined} />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default User;\n","import React from 'react';\nimport $ from 'jquery';\nimport './import.css';\n\nclass LocalSaves extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      projects: []\n    };\n    this.changedProjects = '';\n  }\n\n  componentWillMount() {\n    if (localStorage.getItem('localProjects')) {\n      const obj = JSON.parse(localStorage.getItem('localProjects'));\n      this.setState({ projects: Object.entries(obj) });\n    }\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  deletePiskel(item) {\n    for (let i = 0; i < this.state.projects.length; i += 1) {\n      if (this.state.projects[i][0] === item) {\n        this.state.projects.splice(i, 1);\n      }\n    }\n\n    this.changedProjects = this.state.projects;\n    window.localProjects = {};\n    for (let k = 0; k < this.changedProjects.length; k += 1) {\n      window.localProjects[this.changedProjects[k][0]] = this.changedProjects[k][1];\n    }\n    this.setState({ projects: this.changedProjects });\n    const projectsJson = JSON.stringify(window.localProjects);\n    localStorage.setItem('localProjects', projectsJson);\n  }\n\n  addPiskel() {\n    if (localStorage.getItem('localProjects')) {\n      const obj = JSON.parse(localStorage.getItem('localProjects'));\n      this.setState({ projects: Object.entries(obj) });\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"local-saves-block\">\n        <div>\n          <span className=\"local-saves-title\">Browse local piskels</span>\n          <i\n            className=\"far fa-window-close local-saves-button\"\n            onClick={() => $('#hideSavesButton').click()}\n            onKeyPress={undefined}\n            tabIndex=\"-1\"\n            role=\"button\"\n          />\n        </div>\n        <table className=\"table-local-saves\" cellPadding=\"10\" cellSpacing=\"20\">\n          <thead>\n            <tr>\n              <th className=\"table-title\">Name</th>\n              <th className=\"table-title\">Date</th>\n              <th className=\"table-title\">Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {this.state.projects.map(item => (\n              <tr key={item[0]}>\n                <td key={item[1].title} className=\"table-data\">\n                  {item[1].title}\n                </td>\n                <td key={item[1].time} className=\"table-data\">\n                  {item[1].time}\n                </td>\n                <td key={`${item[0]}-buttons`} className=\"table-data table-data-buttons\">\n                  <button key={`${item[0]}-load`} type=\"button\" className=\"table-button\">\n                    Load\n                  </button>\n                  <button\n                    key={`${item[0]}-delete`}\n                    type=\"button\"\n                    className=\"table-button\"\n                    onClick={() => this.deletePiskel(item[0])}\n                  >\n                    Delete\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n        <button\n          id=\"addLocalPiskel\"\n          type=\"button\"\n          className=\"hidden\"\n          onClick={() => this.addPiskel()}\n        />\n      </div>\n    );\n  }\n}\n\nexport default LocalSaves;\n","import React from 'react';\nimport $ from 'jquery';\nimport Tools from '../../components/tools/toolsDomBuilder';\nimport Canvas from '../../screens/canvas/canvasDomBuilder';\nimport Frames from '../../components/frames-list/frameDomBuilder';\nimport Preview from '../../screens/preview/previewDomBuilder';\nimport Options from '../../components/menu/optionsDomBuilder';\nimport LocalSaves from '../../components/menu/import/localSaves';\n\nclass CreateAnimation extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      showSaves: false\n    };\n  }\n\n  componentDidMount() {\n    $(window).bind('beforeunload', () => {\n      return 'are you sure you want to leave?';\n    });\n  }\n\n  render() {\n    return (\n      <div id=\"container\" className=\"container\">\n        <section className=\"tool-pannel\" id=\"tool-pannel\">\n          <Tools />\n        </section>\n        <section className=\"frame-area\" id=\"frame-area\">\n          <Frames />\n        </section>\n        <section className=\"canvas-area\" id=\"canvas-area\">\n          <Canvas />\n        </section>\n        <section className=\"preview-area noselect\" id=\"preview-area\">\n          <Preview />\n        </section>\n        <section className=\"options-area\" id=\"options-area\">\n          <Options />\n        </section>\n        <div className={`local-saves-page ${this.state.showSaves ? '' : 'hidden'}`}>\n          <div className=\"local-saves-background\" />\n          <LocalSaves />\n        </div>\n\n        <button\n          type=\"button\"\n          className=\"hidden\"\n          id=\"showSavesButton\"\n          onClick={() => this.setState({ showSaves: true })}\n        />\n        <button\n          type=\"button\"\n          className=\"hidden\"\n          id=\"hideSavesButton\"\n          onClick={() => this.setState({ showSaves: false })}\n        />\n      </div>\n    );\n  }\n}\n\nexport default CreateAnimation;\n","/* eslint-disable no-bitwise */\nimport React from 'react';\nimport $ from 'jquery';\nimport { Redirect } from 'react-router-dom';\nimport { preview, store } from '../../store/store';\n\nfunction makeRandomId() {\n  const j = [];\n  let x;\n  for (let i = 0; i < 20; i += 1) {\n    x = [[48, 57], [65, 90], [97, 122]][(Math.random() * 3) >> 0];\n    j[i] = String.fromCharCode(((Math.random() * (x[1] - x[0] + 1)) >> 0) + x[0]);\n  }\n  return j.join('');\n}\n\nclass About extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      page: ''\n    };\n    this.id = '';\n  }\n\n  isRedirected(span) {\n    if (this.state.page) {\n      return <Redirect to={`/create-animation/${this.id}`} />;\n    }\n    if (span) {\n      return <span className=\"description-link\">Create a new Sprite</span>;\n    }\n    return <span className=\"link\">Create Sprite</span>;\n  }\n\n  render() {\n    return (\n      <div className=\"homepage-section\">\n        <div className=\"home-about\">\n          <h1>\n            <span className=\"piskel\">Piskel-clone </span>\n            is a free online editor for animated sprites & pixel art\n          </h1>\n          <h2>Create animations in your browser.</h2>\n          <h2>\n            <span className=\"description-link\">Try an example</span>\n            {', use '}\n            <span\n              role=\"button\"\n              tabIndex=\"-1\"\n              onKeyPress={undefined}\n              className=\"description-link\"\n              onClick={() => $('.abcRioButton.abcRioButtonLightBlue').click()}\n            >\n              Google sign in\n            </span>\n            {' to access your gallery or simply '}\n            <button\n              type=\"button\"\n              className=\"text-button\"\n              onClick={() => {\n                this.id = makeRandomId();\n                preview.dispatch({ type: 'piskelID', value: this.id });\n                store.dispatch({ type: 'currentPage', value: `create-animation/${this.id}` });\n                this.setState({ page: `create-animation/${this.id}` });\n                localStorage.setItem('page', `create-animation/${this.id}`);\n                localStorage.setItem('auth', false);\n                localStorage.setItem('project', this.id);\n                $(document.body).css({ cursor: 'default' });\n              }}\n            >\n              {this.isRedirected('span')}\n            </button>\n          </h2>\n          <div className=\"home-buttons\">\n            <button\n              type=\"button\"\n              className=\"login-button\"\n              onClick={() => $('.abcRioButton.abcRioButtonLightBlue').click()}\n            >\n              Sign in\n            </button>\n            <button\n              type=\"button\"\n              className=\"create-button\"\n              onClick={() => {\n                this.id = makeRandomId();\n                preview.dispatch({ type: 'piskelID', value: this.id });\n                this.setState({ page: `create-animation/${this.id}` });\n                localStorage.setItem('page', `create-animation/${this.id}`);\n                localStorage.setItem('auth', false);\n                localStorage.setItem('project', this.id);\n                $(document.body).css({ cursor: 'default' });\n              }}\n            >\n              {this.isRedirected()}\n            </button>\n          </div>\n        </div>\n\n        <div className=\"home-image\">\n          <div className=\"screen\" />\n          <div className=\"home-preview\" />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport { About, makeRandomId };\n","/* eslint-disable no-alert */\nimport React from 'react';\nimport { Redirect, Route, Link, HashRouter, Switch } from 'react-router-dom';\nimport './home.css';\nimport $ from 'jquery';\nimport CreateAnimation from './create/create';\nimport User from './user/user';\nimport { About, makeRandomId } from './about/about';\nimport { user, preview } from '../store/store';\n\nclass AppRouter extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      id: '',\n      name: '',\n      img: '',\n      redirected: '',\n      active: ''\n    };\n    this.onSuccess = this.onSuccess.bind(this);\n  }\n\n  componentWillMount() {\n    if (!localStorage.getItem('page')) {\n      this.setState({ redirected: '' });\n    } else {\n      this.setState({ redirected: localStorage.getItem('page') });\n    }\n  }\n\n  componentDidMount() {\n    setTimeout(() => {\n      $(document.body).ready(() => {\n        window.gapi.load('client:auth2', () => {\n          window.gapi.auth2\n            .init({\n              client_id: '717448332612-evijnpopt50fj6vp0d9iul50sgdout90.apps.googleusercontent.com'\n            })\n            .then(() => {\n              window.gapi.signin2.render('my-signIn', {\n                scope: 'https://www.googleapis.com/auth/drive.file',\n                width: 240,\n                height: 37,\n                longtitle: true,\n                onsuccess: this.onSuccess,\n                onfailure: this.onFailure\n              });\n            });\n        });\n      });\n    }, 200);\n  }\n\n  onSuccess(googleUser) {\n    const profile = googleUser.getBasicProfile();\n    const ID = profile.getId();\n    const fullName = profile.getName();\n    const imageURL = profile.getImageUrl();\n    const email = profile.getEmail();\n    user.dispatch({ type: 'email', value: email });\n    user.dispatch({ type: 'userID', value: ID });\n    localStorage.setItem('userID', ID);\n    user.dispatch({ type: 'name', value: fullName });\n    this.setState({ id: ID, name: fullName, img: imageURL });\n    $('#updateSaveButtonLoggedIn').click();\n    $('#updateGoogleButtonLoggedIn').click();\n    if (localStorage.getItem('page')) {\n      if (localStorage.getItem('page').indexOf('create') !== -1) {\n        localStorage.setItem('auth', false);\n      } else {\n        localStorage.setItem('auth', false);\n        this.setState({ redirected: localStorage.getItem('page') });\n      }\n    } else {\n      localStorage.setItem('auth', true);\n      localStorage.setItem('page', `user/${ID}`);\n      this.setState({ redirected: `user/${ID}` });\n      $(document.body).css({ cursor: 'default' });\n    }\n  }\n\n  signOut() {\n    const auth2 = window.gapi.auth2.getAuthInstance();\n    auth2.signOut().then(() => {\n      this.setState({ redirected: '', id: '' });\n      localStorage.setItem('page', '');\n      localStorage.setItem('auth', false);\n      user.dispatch({ type: 'name', value: '' });\n    });\n  }\n\n  isRedirected() {\n    user.dispatch({ type: 'imageURL', value: this.state.img });\n    if (!localStorage.getItem('page')) {\n      return <Redirect to=\"/\" />;\n    }\n    if (this.state.redirected) {\n      return <Redirect to={`/${this.state.redirected}`} />;\n    }\n    return <Redirect to=\"/\" />;\n  }\n\n  addActiveClass(e) {\n    const clicked = e.currentTarget.getAttribute('id');\n    if (this.state.active === clicked) {\n      this.setState({ active: '' });\n    } else {\n      this.setState({ active: clicked });\n    }\n  }\n\n  render() {\n    return (\n      <HashRouter>\n        <div>\n          <header className=\"header\">\n            <div className=\"header-menu\">\n              <span className=\"menu-icon\">\n                <i className=\"fas fa-bars\" />\n              </span>\n              <ul className=\"menu\">\n                <li className=\"homepage\">\n                  <Link\n                    to=\"/\"\n                    className=\"task-name\"\n                    onClick={e => {\n                      if (localStorage.getItem('page')) {\n                        if (localStorage.getItem('page').indexOf('create') !== -1) {\n                          // eslint-disable-next-line no-restricted-globals\n                          if (confirm('Are you sure you want to leave?') === true) {\n                            this.setState({ redirected: 'about' });\n                            localStorage.setItem('page', 'about');\n                            localStorage.setItem('auth', false);\n                            $(document.body).css({ cursor: 'default' });\n                            return;\n                          }\n                          e.preventDefault();\n                        } else {\n                          this.setState({ redirected: 'about' });\n                          localStorage.setItem('page', 'about');\n                          localStorage.setItem('auth', false);\n                          $(document.body).css({ cursor: 'default' });\n                        }\n                      }\n                    }}\n                  >\n                    Piskel-clone\n                  </Link>\n                </li>\n                <li className=\"create menu-item\">\n                  <Link\n                    to=\"/create-animation\"\n                    className=\"create-link\"\n                    onClick={e => {\n                      if (localStorage.getItem('page')) {\n                        if (localStorage.getItem('page').indexOf('create') !== -1) {\n                          // eslint-disable-next-line no-restricted-globals\n                          if (confirm('Are you sure you want to leave?') === true) {\n                            const piskel = makeRandomId();\n                            preview.dispatch({ type: 'piskelID', value: piskel });\n                            this.setState({ redirected: `create-animation/${piskel}` });\n                            localStorage.setItem('page', `create-animation/${piskel}`);\n                            localStorage.setItem('auth', false);\n                            localStorage.setItem('project', piskel);\n                            $(document.body).css({ cursor: 'default' });\n                            return;\n                          }\n                          e.preventDefault();\n                          return;\n                        }\n                      }\n                      const piskel = makeRandomId();\n                      preview.dispatch({ type: 'piskelID', value: piskel });\n                      this.setState({ redirected: `create-animation/${piskel}` });\n                      localStorage.setItem('page', `create-animation/${piskel}`);\n                      localStorage.setItem('auth', false);\n                      localStorage.setItem('project', piskel);\n                      $(document.body).css({ cursor: 'default' });\n                    }}\n                  >\n                    Create Animation\n                  </Link>\n                </li>\n                <li className=\"signin\">\n                  <div\n                    className={`menu-item ${this.state.id ? 'account' : 'hidden'}`}\n                    id=\"list\"\n                    role=\"button\"\n                    tabIndex=\"-1\"\n                    onKeyPress={undefined}\n                    onClick={e => {\n                      this.addActiveClass(e);\n                    }}\n                  >\n                    <div\n                      className=\"account-image\"\n                      style={{\n                        backgroundImage: `url(${this.state.img})`,\n                        backgroundSize: 'contain'\n                      }}\n                    />\n                    <span className=\"account-button\">{this.state.name}</span>\n                    <i className=\"fas fa-sort-down\" />\n                    <ul\n                      className={`dropdown ${this.state.active === 'list' ? 'active' : 'hidden'}`}\n                    >\n                      <li className={`list top ${this.state.active === 'list' ? '' : 'hidden'}`}>\n                        <Link\n                          to={`/user/${this.state.id}`}\n                          id=\"galery\"\n                          className=\"account-item\"\n                          onClick={e => {\n                            if (localStorage.getItem('page')) {\n                              if (localStorage.getItem('page').indexOf('create') !== -1) {\n                                // eslint-disable-next-line no-restricted-globals\n                                if (confirm('Are you sure you want to leave?') === true) {\n                                  localStorage.setItem('auth', true);\n                                  localStorage.setItem('page', `user/${this.state.id}`);\n                                  this.setState({ redirected: localStorage.getItem('page') });\n                                  $(document.body).css({ cursor: 'default' });\n                                  return;\n                                }\n                                e.preventDefault();\n                              } else {\n                                localStorage.setItem('auth', true);\n                                localStorage.setItem('page', `user/${this.state.id}`);\n                                this.setState({ redirected: localStorage.getItem('page') });\n                                $(document.body).css({ cursor: 'default' });\n                              }\n                            }\n                          }}\n                        >\n                          My Galery\n                        </Link>\n                      </li>\n                      <li className={`list bottom ${this.state.active === 'list' ? '' : 'hidden'}`}>\n                        <Link\n                          to={`/${this.state.redirected}`}\n                          id=\"logout\"\n                          className=\"account-item\"\n                          onClick={() => {\n                            // eslint-disable-next-line no-restricted-globals\n                            if (confirm('Are you sure you want to leave?') === true) {\n                              this.signOut();\n                            }\n                          }}\n                        >\n                          Log out\n                        </Link>\n                      </li>\n                    </ul>\n                  </div>\n                  <div\n                    id=\"my-signIn\"\n                    className={`${this.state.id ? 'hidden' : 'shown'}`}\n                    onClick={() => {\n                      localStorage.setItem('auth', true);\n                    }}\n                    onKeyPress={() => undefined}\n                    role=\"button\"\n                    tabIndex=\"-1\"\n                  />\n                  {this.isRedirected()}\n                </li>\n              </ul>\n            </div>\n          </header>\n          <Switch>\n            <Route path=\"/\" exact component={About} />\n            <Route path={`/user/${this.state.id}`} component={User} />\n            <Route path=\"/create-animation/*\" component={CreateAnimation} />\n            <Route path=\"*\" component={About} />\n          </Switch>\n        </div>\n      </HashRouter>\n    );\n  }\n}\n\nexport default AppRouter;\n","/* eslint-disable no-param-reassign */\n/* eslint-disable no-console */\n/* eslint-disable no-use-before-define */\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { HashRouter } from 'react-router-dom';\nimport './index.css';\nimport AppRouter from './mainpage/home';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <HashRouter>\n    <AppRouter />\n  </HashRouter>,\n  document.getElementById('home-page')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}